/*! courier 21-07-2023 */
!function(){function a(a,b){var c;window.CustomEvent?c=new CustomEvent(a,{detail:b}):(c=document.createEvent("CustomEvent"),c.initCustomEvent(a,!0,!0,{detail:b})),document.dispatchEvent(c)}function b(){var a=new Date;return a.setHours(24,0,0,0),a.getTime()}function c(){return Date.now()}function d(a){const b=document.cookie.indexOf(a+"=");if(-1!==b){const c=document.cookie.indexOf(";",b+1),d=b+a.length+1;return document.cookie.substring(d,c)}return null}function e(a){for(var b=document.cookie.split("; "),c=[],d=0;d<b.length;d++){var e=b[d].trim(),f=e.split("=");a?f[0].match(a)&&c.push(f):c.push(f)}return c}function f(a,b,c,d){d=void 0!==d&&d;var e="";if(c){var f=new Date;f.setTime(f.getTime()+24*c*60*60*1e3),e="; expires="+f.toUTCString()}var g=a+"="+(b||"")+e+"; path=/";if(d){var h=window.location.hostname.split(".");1==h.length?g+="; domain=."+h[0]:g+="; domain=."+h.slice(-2).join("."),console.log(g)}document.cookie=g}function g(){return window.screen.width<768?"mobile":window.screen.width<=1024?"tablet":"desktop"}function h(a,b){if(window.webkitRequestFileSystem)return void window.webkitRequestFileSystem(0,0,b,a);if("MozAppearance"in document.documentElement.style){const c=indexedDB.open("test");return c.onerror=a,void(c.onsuccess=b)}const d=navigator.userAgent.match(/Version\/([0-9\._]+).*Safari/);if(d){const e=parseInt(d[1],10);if(e>=11)try{return window.openDatabase(null,null,null,null),b()}catch(b){return a()}else if(e<11){try{localStorage.length?b():(localStorage.x=1,localStorage.removeItem("x"),b())}catch(c){navigator.cookieEnabled?a():b()}return}}return window.PointerEvent||window.MSPointerEvent?window.indexedDB?b():a():b()}var i=function(a,b){this.courierClient=a,this.queue=b};i.prototype.push=function(a){this.queue.push(a),this.courierClient.processOps()};var j=function(){this.iframeParent=null,this.loadingComplete=!1,this.hasShown=!1,this.scrollPosition=0,this.environment="production",this.courierUrl="",this.courierFrameUrl="",this.courierClientQueue=new i(this,window.crq||[]),window.crq=this.courierClientQueue,this.processOps()};j.prototype.processOps=function(){for(;this.courierClientQueue.queue.length;){var a=this.courierClientQueue.queue.shift();switch(a.command){case"init":switch(this.iframeParent="iframeParent"in a?a.iframeParent:document.getElementsByTagName("body")[0],this.environment="environment"in a?a.environment:"production",this.environment){default:case"production":this.courierUrl="https://courier-js.dallasnews.com",this.courierFrameUrl=this.courierUrl+"/production/courier.html?"+Date.now();break;case"sandbox":this.courierUrl="https://courier-js.lb1.lifeblue.us",this.courierFrameUrl=this.courierUrl+"/sandbox/courier.html?"+Date.now();break;case"stage":this.courierUrl="https://courier-js-stage.test.dallasnews.com",this.courierFrameUrl=this.courierUrl+"/stage/courier.html?"+Date.now();break;case"stage-one":this.courierUrl="https://courier-js-stage-one.test.dallasnews.com",this.courierFrameUrl=this.courierUrl+"/stage-one/courier.html?"+Date.now();break;case"stage-two":this.courierUrl="https://courier-js-stage-two.test.dallasnews.com",this.courierFrameUrl=this.courierUrl+"/stage-two/courier.html?"+Date.now();break;case"stage-three":this.courierUrl="https://courier-js-stage-three.test.dallasnews.com",this.courierFrameUrl=this.courierUrl+"/stage-three/courier.html?"+Date.now();break;case"stage-four":this.courierUrl="https://courier-js-stage-four.test.dallasnews.com",this.courierFrameUrl=this.courierUrl+"/stage-four/courier.html?"+Date.now();break;case"stage-five":this.courierUrl="https://courier-js-stage-five.test.dallasnews.com",this.courierFrameUrl=this.courierUrl+"/stage-five/courier.html?"+Date.now();break;case"stage-six":this.courierUrl="https://courier-js-stage-six.test.dallasnews.com",this.courierFrameUrl=this.courierUrl+"/stage-six/courier.html?"+Date.now();break;case"stage-seven":this.courierUrl="https://courier-js-stage-seven.test.dallasnews.com",this.courierFrameUrl=this.courierUrl+"/stage-seven/courier.html?"+Date.now();break;case"arc":this.courierUrl="https://courier-js-arc.test.dallasnews.com",this.courierFrameUrl=this.courierUrl+"/arc/courier.html?"+Date.now();break;case"davidm":this.courierUrl="http://dmn-courier-js",this.courierFrameUrl=this.courierUrl+"/davidm/courier.html?"+Date.now();break;case"local":this.courierUrl="http://courier-js.jafar.docker.ninja",this.courierFrameUrl=this.courierUrl+"/local/courier.html?"+Date.now();break;case"jonny":this.courierUrl="http://local.dmncourierframe.com",this.courierFrameUrl=this.courierUrl+"/sandbox/courier.html?"+Date.now();break;case"gavin":this.courierUrl="http://js.courier.dmn",this.courierFrameUrl=this.courierUrl+"/gavin/courier.html";break;case"travis":this.courierUrl="http://courier-js.local",this.courierFrameUrl=this.courierUrl+"/travis/courier.html";break;case"stan":this.courierUrl="http://dev.dmncourier.js",this.courierFrameUrl=this.courierUrl+"/stan/courier.html";break;case"rlane":this.courierUrl="http://lcourier-js.dallasnews.com",this.courierFrameUrl=this.courierUrl+"/rlane/courier.html"}this.variables="variables"in a?a.variables:{},this.midnightLto=!("midnightLto"in a)||a.midnightLto,this.init();break;case"check":this.recheck()}}},j.prototype.styleWrapper=function(a){a.style.position="relative",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="0px",a.style.overflow="hidden",a.style.zIndex="2147483647",a.style.backgroundColor="rgba(0, 0, 0, .85)"},j.prototype.styleSubWrapper=function(a){a.style.padding="4vh 0 6vh 0",a.style.width="95%",a.style.maxWidth="1000px",a.style.margin="0 auto"},j.prototype.styleFrame=function(a){a.style.width="100%",a.style.height="100%",a.style.margin="0 auto",a.style.display="block",a.style.border="0px",a.style.boxSizing="border-box"},j.prototype.hide=function(){this.iframeWrapper.style.height="0px",this.iframeWrapper.style.minHeight="0px",this.iframeWrapper.style.overflow="hidden";var a=document.getElementsByTagName("body");if(a=a.length?a[0]:null){a.style.overflow="initial";var b=document.getElementById("courier-body-wrapper");if(b){var c=Array.prototype.slice.call(b.childNodes);[].forEach.call(c,function(c){a.insertBefore(c,b)}),a.removeChild(b),"number"==typeof this.scrollPosition&&window.scrollTo(0,this.scrollPosition)}}},j.prototype.show=function(){if(!window.loginOpen){var a=this;this.hasShown=!0,this.scrollPosition=document.body.scrollTop,this.iframeWrapper.style.height="auto",this.iframeWrapper.style.minHeight="100vh",this.iframeWrapper.style.webkitOverflowScrolling="touch";var b=document.getElementsByTagName("body");if(b=b.length?b[0]:null){console.log("wrapping");var c=document.createElement("div");c.id="courier-body-wrapper",c.style.position="fixed",c.style.top="0px",c.style.right="0px",c.style.bottom="0px",c.style.left="0px";var d=Array.prototype.slice.call(b.childNodes);b.insertBefore(c,this.iframeParent),[].forEach.call(d,function(b,d){void 0!==b.getAttribute&&b.getAttribute("id")===a.iframeParent.getAttribute("id")||c.appendChild(b)})}}},j.prototype.refresh=function(){window.location.reload(!0)},j.prototype.recheck=function(){if(this.loadingComplete&&!this.hasShown){var a=this.courierUrl;this.iframe.contentWindow.postMessage({command:"reload"},a)}},j.prototype.resizeIframe=function(a){this.iframe.style.height=a+"px"},j.prototype.manageMidnightLto=function(){var a=d("courier_lto"),e=d("courier_lto_expire");if(null===a)f("courier_lto","1",365),f("courier_lto_expire",b(),365);else if("1"==a){var g=e-c();g<0&&f("courier_lto","0",365)}if("1"==(a=d("courier_lto"))){this.variables.ltoActive=!0,e=parseInt(d("courier_lto_expire"));var h=(new Date).getTime(),i=e-h,j=parseInt(i/1e3),k=Math.floor(j/3600),l=Math.floor(j/60)-60*k,m="";if(0===k)m=l<=1?"1 Minute":l.toString()+" Minutes";else{var n=1==k?"1 Hour":k.toString()+" Hours",o="";o=0===l?"":1==l?"1 Minute":l.toString()+" Minutes",m=n+" "+o,m=m.trim()}this.variables.ltoRemaining=m}else this.variables.ltoActive=!1},j.prototype.init=function(){this.midnightLto&&this.manageMidnightLto();var b=this.courierUrl,c=this.courierFrameUrl,i=this.variables,j=this;this.iframeWrapper=document.createElement("div"),this.iframeSubWrapper=document.createElement("div"),this.styleWrapper(this.iframeWrapper),this.styleSubWrapper(this.iframeSubWrapper),this.iframe=document.createElement("iframe"),this.styleFrame(this.iframe),this.iframe.src=c,this.iframeParent.appendChild(this.iframeWrapper),this.iframeWrapper.appendChild(this.iframeSubWrapper),this.iframeSubWrapper.appendChild(this.iframe),this.hide();var k=!1;h(function(){k=!0},function(){k=!1}),this.iframe.onload=function(){this.contentWindow.postMessage({command:"host-load",message:{page:window.location.href,referrer:document.referrer,identity:{tracker:d("courier_tk"),dmnp:d("DMN-P")},cookies:e(/^courier_.*$/),variables:i,deviceType:g(),incognitoEnabled:k}},b),j.loadingComplete=!0,a("courier/load",{})},window.addEventListener("message",function(b){if(b.origin===this.courierUrl&&"command"in b.data){switch(b.data.command){case"sow":switch(b.data.key){case"DMN-P":default:f(b.data.key,b.data.value,b.data.expire,!0)}break;case"sub-data":a("courier/sub-data",{data:b.data});break;case"show":case"show-static":this.show(),a("courier/show",{data:b.data});break;case"no-show":a("courier/no-show",{data:b.data});break;case"hide":this.hide(),a("courier/hide",{data:b.data});break;case"account-login":case"refresh":a("courier/hide",{data:b.data}),this.refresh();break;case"size-change":this.resizeIframe(b.data.height);break;case"scroll-to":this.scrollTo(b.data.position);break;case"terms-shown":break;case"account-purchase":a("courier/convert",{data:b.data})}this.notifyMather(b.data)}}.bind(this),!1)},j.prototype.scrollTo=function(a){window.scrollTo(0,a)},j.prototype.notifyMather=function(a){switch(window.top._matherq=window.top._matherq||[],window.top.fbq=window.top.fbq||[],a.command){case"show":window.top._matherq.push(["paywallEvent",{type:"paywall",category:"block",action:"stop"},this.getMatherOptions()]);for(var b=[],c=0;c<a.plans.length;c++)b.push(this.planToMatherOffer(a.plans[c]));window.top._matherq.push(["paywallEvent",{category:"payment",action:"subscriptions_offered",offers:b},this.getMatherOptions()]);break;case"select-plan":window.top._matherq.push(["paywallEvent",{category:"payment",action:"subscription_selected",offers:[this.planToMatherOffer(a.plan)]},this.getMatherOptions()]),window.top._matherq.push(["paywallEvent",{category:"payment",action:"address_information"},this.getMatherOptions()]),window.top._matherq.push(["paywallEvent",{category:"payment",action:"payment_information"},this.getMatherOptions()]);break;case"account-purchase":window.top._matherq.push(["paywallEvent",{category:"payment",action:"completed"},this.getMatherOptions()]),window.top.fbq("trackSingle","1886780824893130","Purchase",{value:a.amount,currency:"USD"});break;case"account-login":window.top._matherq.push(["paywallEvent",{category:"payment",action:"logon"},this.getMatherOptions()]);break;case"terms-shown":window.top._matherq.push(["paywallEvent",{category:"payment",action:"terms_and_conditions"},this.getMatherOptions()])}j.prototype.planToMatherOffer=function(a){if(a&&"detail"in a){var b=a.detail.planIntervalUnit.match(/(.*)s$/),c=b&&b.length>1?b[1]:a.detail.planIntervalUnit;return{offerId:a.code,offerName:a.detail.name,price:a.detail.amount,per:c,termAmount:a.detail.planIntervalLength,termUnit:c}}},j.prototype.getMatherOptions=function(){return null},j.prototype.getUserId=function(){var a=d("courier_tk");return a||null}},new j}();