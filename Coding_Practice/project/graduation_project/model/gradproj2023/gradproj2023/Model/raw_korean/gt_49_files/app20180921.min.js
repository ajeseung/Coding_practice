window.locale={},$.fn.matchHeight=function(){console&&console.log("matchHeight")},$.fn.matchHeight._update=function(){console&&console.log("matchHeight._update")};var ie9=!1,ie8=!1,ie7=!1;$("html").hasClass("lt-ie8")?ie7=!0:$("html").hasClass("lt-ie9")?ie8=!0:$("html").hasClass("lt-ie10")&&(ie9=!0),Number.prototype.padLeft=function(a,b){return b||(b=" "),(""+this).length>=a?""+this:arguments.callee.call(b+this,a,b)},window.console||(window.console={log:function(){},warn:function(){}});var DEBUGMODE=function(){var a=!1,b=window.location.search.split("?"),c=[],d={},e=!!window.localStorage;return b.length>1&&(c=b[1].split("&"),c.map(function(a){var b=a.split("=");d[b[0]]=b[1]})),e&&(a=!!localStorage.getItem("jsDebug")),d.hasOwnProperty("js-debug")&&(a="1"===d["js-debug"]?!0:!1),e&&localStorage.setItem("jsDebug",a),a}();$.extend({hook:function(a,b){var c;return c=a&&"*"!==a?'[data-hook~="'+a+'"]':"[data-hook]",b&&(c='[data-hook~="'+b+'"] '+c),$(c)},documentHook:function(a,b,c,d){var e;e=a&&"*"!==a?'[data-hook~="'+a+'"]':"[data-hook]",d&&(e='[data-hook~="'+d+'"] '+e),$(document).on(b,e,c)}});var ExpressApp=window.ExpressApp||{};$.extend(ExpressApp,{Log:function(a){var b=Error;b.prototype.write=function(a){var b="\r\n@ "+(this.lineNumber?this.fileName+":"+this.lineNumber+":1":c(this.stack));a.unshift("%c[DX]","background: #9f021e; color: #fff;"),a=a.concat([b]),console&&console.log&&(console.log.apply?console.log.apply(console,a):console.log(a))};var c=function(a){var b=a.split("\n"),c=b[2]||b.pop();return c=c.indexOf(" (")>=0?c.split(" (")[1].substring(0,c.length-1):c.split("at ")[1]};return function(){typeof DEBUGMODE!=typeof a&&DEBUGMODE&&b().write(Array.prototype.slice.call(arguments,0))}}(),Config:{inProduction:!1,amazonAds:!1,webrootImg:null,webrootImgDynamic:null},Supports:{_supported:{},details:function(){return this._supported.hasOwnProperty("details")||(this._supported.details=function(a){var b,c,d,e=a.createElement("details");return"open"in e?(c=a.body||function(){var c=a.documentElement;return b=!0,c.insertBefore(a.createElement("body"),c.firstElementChild||c.firstChild)}(),e.innerHTML="<summary>a</summary>b",e.style.display="block",c.appendChild(e),d=e.offsetHeight,e.open=!0,d=d!=e.offsetHeight,c.removeChild(e),b&&c.parentNode.removeChild(c),d):!1}(document)),this._supported.details}},Helper:{JSON:{GetLength:function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b},ParseFromString:function(a){var b={};if("string"==typeof a&&(a=a.split(";"),a.length))for(var c in a){var d=a[c].split(":");d.length&&(b[$.trim(d[0])]=$.trim(d[1]))}return b}},Now:Date.now||function(){return(new Date).getTime()},Throttle:function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:ExpressApp.Helper.Now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=ExpressApp.Helper.Now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(g&&(clearTimeout(g),g=null),h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},Debounce:function(a,b,c){var d,e,f,g,h,i=function(){var j=ExpressApp.Helper.Now()-g;b>j&&j>=0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=ExpressApp.Helper.Now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}}},Preload:{Start:function(a,b){var c=a.position();b=$.extend({},{type:1,left:c.left+(a[0].offsetWidth-45)/2,top:c.top+(a[0].offsetHeight-45)/2,bottom:"auto",right:"auto"},b),a.after('<span class="preloader v'+b.type+'"/>'),a.next("span.preloader").css({position:"absolute",left:b.left,top:b.top,bottom:b.bottom,right:b.right,width:45,height:45})},Stop:function(a){a.next("span.preloader").remove()}},Comments:{count:0,LoadMore:function(a,b,c){c=$.extend({},{url:!1,itemTpl:"tmpl_comment_item",limit:25,inProduction:!1},c),c.url||(c.url=$(a).attr("href")),$(document).on("click",a,function(d){if(d.preventDefault(),this._locked)return!1;this._locked=!0,$(a).addClass("blocked");var e=this,f=$(b).children().last();return $.ajax({url:c.url,dataType:"json",success:function(d){var g=$(a).attr("href").split("?"),h=$.parseParams(g[1]);void 0==typeof h.l&&(h.l=parseInt(c.limit)),void 0==typeof h.o&&(h.o=0),h.o=parseInt(h.o)+parseInt(h.l),"function"==typeof window.history.pushState&&window.history.pushState({},"",g.join("?")),c.inProduction&&("object"==typeof _gaq&&_gaq.push(["_trackPageview"],g.join("?")),"function"==typeof ga&&ga("send","pageview",g.join("?"))),ExpressApp.Parsely.TrackDynamicContent(g.join("?"),document.referrer,"comments - load more"),g[1]=$.param(h),$(a).attr("href",g.join("?")),c.url=g.join("?");for(var i=0;i<d.length;i++){var j=d[i];j.className=f.hasClass("even")?i%2==0?"odd":"even":i%2==0?"even":"odd",j.Comment.title=j.Comment.title||j.Comment.comment,$(b).append(tmpl(c.itemTpl,j)),$(b).children().last().fadeIn("slow")}e._locked=!1,$(a).removeClass("blocked"),d.length<c.limit&&$(a).hide()},error:function(){},beforeSend:function(){ExpressApp.Preload.Start($(a),{left:530})},complete:function(){ExpressApp.Preload.Stop($(a))}}),!1})},ListAll:function(a,b,c){var d,e,f=($(a),this);c=$.extend({},{url:!1,expanded:"Show First 5 Comments<var><br></var>",collapsed:"Load More ({count} Comments)<var><br></var>",expandedCallback:$.noop,collapsedCallback:$.noop,itemTpl:"comment_item",loaded:!1,limit:5},c),d=e=c.loaded,c.url||(c.url=$(a).attr("href")),$(document).on("click",a,function(){if(d)if(e){e=!1;for(var g=$("<div/>"),h=g.queue(),i=$(b).children(),j=f.count-1;j>4;j--)h.push($.proxy(function(a){i.eq(this.it).slideUp("fast",function(){a()})},{it:j}));g.queue(h),$(this).html(c.collapsed.replace("{count}",f.count-c.limit)).removeClass("expanded"),c.collapsedCallback(f,$(a),$(b))}else{e=!0;for(var g=$("<div/>"),h=g.queue(),i=$(b).children(),j=5;j<f.count;j++)h.push($.proxy(function(a){i.eq(this.it).slideDown("fast",function(){a()})},{it:j}));g.queue(h),$(this).html(c.expanded).addClass("expanded"),c.expandedCallback(f,$(a),$(b))}else $.ajax({url:c.url,dataType:"json",success:function(d){$(a).html(c.expanded).addClass("expanded"),f.count=d.length;for(var e in d)e>4&&(d[e].hide=!0,$(b).append(tmpl(c.itemTpl,d[e])));for(var g=$("<div/>"),h=g.queue(),i=$(b).children(),e=4;e<f.count;e++)h.push($.proxy(function(a){i.eq(this.it).slideDown("fast",function(){a()})},{it:e}));g.queue(h),c.expandedCallback(f,$(a),$(b))},error:function(){},beforeSend:function(){ExpressApp.Preload.Start($(a))},complete:function(){ExpressApp.Preload.Stop($(a))}}),d=!0,e=!0;return!1})},Add:function(a,b,c){var d=this;c=$.extend({},{url:$(a).attr("action"),data:{},before:!0,reset:!0,event:"submit",itemTpl:"comment_item",boxTpl:"comments_box",panelTpl:"comments_panel",all:!1,updateCount:$.noop,beforeSend:function(){return!0}},c),$(a).bind(c.event||"submit",function(){return c.beforeSend(d,a)&&$.ajax({type:"POST",url:c.url,data:$(this).serialize()+"&"+$.param(c.data),success:function(e){if(e)if(e.auth){var f=$.Event("auth.express");$(a).trigger(f)}else if(e.error)for(var g in e.messages)e.messages.hasOwnProperty(g)&&$('[name="'+g+'"]').parent().find(".error-message").text(e.messages[g]);else{if(1==e.count){var h=tmpl(c.itemTpl,e);$(".comment-form").after(tmpl(c.boxTpl,{count:e.count,comment:h})),$(b).children().last().slideDown("fast")}else{if(6==e.count&&!c.all){var i=tmpl(c.panelTpl,{count:1});$(b).parent().append(i)}c.before?($(b).prepend(tmpl(c.itemTpl,e)),$(b).children().first().slideDown("fast"),e.count>5&&!c.all&&$(b).children().eq(5).slideUp("fast",function(){})):($(b).append(mpl(c.itemTpl,e)),$(b).children().last(":visible").slideDown("fast"),e.count>5&&!c.all&&$(b).children().first().slideUp("fast",function(){}))}d.count++,c.updateCount(d,d.count)}},beforeSend:function(){ExpressApp.Preload.Start($("[type=submit]",$(a)))},complete:function(){ExpressApp.Preload.Stop($("[type=submit]",$(a))),c.reset&&($(a).find("[type=text], textarea").not("[readonly]").val("").keyup(),$(a).find(":checked").attr("checked",!1))}}),!1})}},Weather:{weatherWidgetTrigger:"#weatherArea",weatherWidgetIcoSize:"25x25",loading:!1,GetWeather:function(){if(!ExpressApp.Weather.loading){ExpressApp.Weather.loading=!0;var a=$.cookie("weatherData_Weather");a?(ExpressApp.Weather.FillInWeatherWidget($.parseJSON(a)),$(ExpressApp.Weather.weatherWidgetTrigger).find("a").addClass("in")):ExpressApp.Weather.GetWeatherData(),ExpressApp.Weather.loading=!1}},RefreshWather:function(){},SetWeatherCookie:function(a){return{location_id:a.location_id,sky_code:a.sky_code,centigrade:a.centigrade,town:a.town,country_code:a.country_code}},GetWeatherData:function(){var a=$(ExpressApp.Weather.weatherWidgetTrigger),b=$.cookie("weatherData_LocationCode");$.ajax({url:"/weather/get/"+(b?b:"UKXX0085"),success:function(a){ExpressApp.Weather.FillInWeatherWidget(a),$.cookie("weatherData_Weather",JSON.stringify(ExpressApp.Weather.SetWeatherCookie(a)),{expires:.02,path:"/"})},beforeSend:function(){ExpressApp.Preload.Start(a,{left:"auto",right:297})},complete:function(){ExpressApp.Preload.Stop(a),a.find("a").addClass("in")}})},FillInWeatherWidget:function(a){var b=$(ExpressApp.Weather.weatherWidgetTrigger);b.find(".weather-info").attr("href",ExpressApp.Weather.weatherForecastUrl.replace("{LOCATION_ID}",a.location_id)),b.find("a").attr("style",'background-image:url("'+ExpressApp.Weather.weatherForecastThumb.replace("{ICO_SIZE}",ExpressApp.Weather.weatherWidgetIcoSize).replace("{SKY_CODE}",parseInt(a.sky_code).padLeft(2,"0"))+'")'),b.find(".jq-centigrade").text(a.centigrade),b.find(".jq-town").text(a.town),b.find(".jq-country_code").text(a.country_code)}},Search:{Bind:function(a){var b=$(a);b.on("submit",document,function(){var a=$(this);if(a.data("searched"))return!0;a.data("searched",!0);var b=$.trim($("[type=search]",a).val()),c=a.attr("action"),d=encodeURI(b.replace(/\s+/g,"+")),e=c+"?s="+d;return a.attr("action",e).submit(),!1})},LoadMore:function(a,b,c){c=$.extend({},{url:!1,itemTpl:"tmpl_search_item",limit:10,inProduction:!1,page:!1,itemsCount:!1,loadTwitter:!1,loadGooglePlus:!1},c),c.url||(c.url=$(a).attr("href")),$(document).on("click",a,function(d){if(d.preventDefault(),this._locked)return!1;this._locked=!0,$(a).addClass("blocked");var e=this,f=($(b).children().last(),c.loadTwitter),g=c.loadGooglePlus;return $.ajax({url:c.url+"&aid",dataType:"json",success:function(d){var f=$(a).attr("href").split("?"),g=$.parseParams(f[1]),h=!1;if(c.page?(void 0==typeof g.page&&(g.page=1),g.page++):(void 0==typeof g.o&&(g.o=0),g.o=parseInt(g.o)+parseInt(c.limit)),"function"==typeof window.history.pushState&&window.history.pushState({},"",f.join("?")),c.inProduction&&("object"==typeof _gaq&&_gaq.push(["_trackPageview"],f.join("?")),"function"==typeof ga&&ga("send","pageview",f.join("?"))),ExpressApp.Parsely.TrackDynamicContent(f.join("?"),document.referrer,"Search - load more"),c.itemsCount&&c.page?c.itemsCount<c.limit*g.page&&(h=!0):c.itemsCount&&c.itemsCount<c.limit+g.o&&(h=!0),d.length<c.limit||h?$(a).fadeOut():(f[1]=$.param(g),$(a).attr("href",f.join("?")),c.url=f.join("?")),"undefined"!=typeof d.length)for(var i=0;i<d.length;i++){var j=d[i];$(b).append(tmpl(c.itemTpl,j)),$(b).children().last().fadeIn("slow")}else for(var i in d){var j=d[i];$(b).append(tmpl(c.itemTpl,j)),$(b).children().last().fadeIn("slow")}e._locked=!1,$(a).removeClass("blocked")},error:function(){},beforeSend:function(){ExpressApp.Preload.Start($(a),{left:530})},complete:function(){ExpressApp.Preload.Stop($(a)),f&&twttr.widgets.load(),g&&gapi.follow.go(),$(window).scroll()}}),!1})}},Image:{Load:function(a,b){$(a).length&&$(a).each(function(){var a=$(this).data("Image_Load")||{interval:null,callbacks:[]};a.callbacks.push(b),a.interval=setInterval($.proxy(function(){if($(this).height()>0){var a=$(this).data("Image_Load");for(clearInterval(a.interval);cb=a.callbacks.shift();)"function"==typeof cb&&$.proxy(cb,this)()}},this),10),$(this).data("Image_Load",a)})}},Horoscope:{loading:!1,dropdownTrigger:".horoscopeDropdown",dropdownShellTrigger:".horoscopeDropdownShell",SetHoroscopeCookie:function(a){return{id:a.sign_id,sign:a.sign}},SetHoroscope:function(a){$.cookie("horoscopeData",JSON.stringify(ExpressApp.Horoscope.SetHoroscopeCookie(a)),{expires:365,path:"/"}),window.location.href="/horoscope/forecast/"+a.sign+"/"+a.sign_id},ActivateHoroscopeDropbox:function(){$(ExpressApp.Horoscope.dropdownTrigger).change(function(){var a=$(this).find(":selected");ExpressApp.Horoscope.SetHoroscope({sign_id:a.val(),sign:a.text()})})}},Form:{Validate:function(a,b){var c,d={ajax:{async:!0,dataType:"json",type:"POST"},handle:!0},e=$(a);b=$.extend({},d,b),c=$.extend({},{url:e.attr("action")||window.location.href.toString()},b.ajax,{data:e.serialize(),beforeSend:function(){var b=$.Event("before.validate");b.validate={form:a},e.trigger(b)},success:function(b){var c;b.error?(c=$.Event("error.validate"),c.validate={form:a,data:b.data},e.trigger(c)):(c=$.Event("success.validate"),c.validate={form:a,data:b.data},e.trigger(c))},complete:function(){var b=$.Event("after.validate");b.validate={form:a},e.trigger(b)}}),"boolean"==typeof b.handle&&b.handle&&e.one("before.validate",function(a){var b,c=$("[type=submit]",a.validate.form),d=c.position();switch(c.attr("data-preload")){case"after":b=$.extend(b,{left:d.left+c[0].offsetWidth+10,top:d.top+parseInt(c.css("margin-top")||0)+Math.floor((c[0].offsetHeight-45)/2)});break;case"before":b=$.extend(b,{left:d.left-55,top:d.top+parseInt(c.css("margin-top")||0)+Math.floor((c[0].offsetHeight-45)/2)});break;default:b={}}ExpressApp.Preload.Start(c,b)}),"boolean"==typeof b.handle&&b.handle&&e.one("after.validate",function(a){ExpressApp.Preload.Stop($("[type=submit]",a.validate.form))}),"boolean"==typeof b.handle&&b.handle&&e.one("error.validate",function(a){ExpressApp.Form.Errors(a.validate.form,a.validate.data)}),"boolean"==typeof b.handle&&b.handle&&e.one("success.validate",function(){e.unbind("submit").submit()}),$.ajax(c)},Errors:function(a,b){$(".error",a).removeClass("error"),$.each(b,function(b,c){var d=$('[name="'+b+'"]',a).not("[type=hidden]"),e=$('<div class="errormessage"/>'),f="<span>"+c[0]+"<var><br></var></span>",g=!0;switch(d.attr("type")){case"radio":case"checkbox":g=!1;break;default:g=!0,e.css({"margin-left":d[0].offsetLeft,width:d[0].offsetWidth?d[0].offsetWidth:d.parent().width()})}d.parent().find(".errormessage").length?d.parent().find(".errormessage").replaceWith(e.append(f)):g?d.parent().append(e.append(f)):d.parent().prepend(e.append(f)),d.parent().addClass("error")})}},Modal:{Open:function(a,b,c){var d=2==$(".reveal-dynamic").length,e=d?$(".reveal-dynamic:hidden").last():$("<div>").addClass("reveal-modal reveal-dynamic").appendTo("body"),f=$(b),g=null,a=a||f.attr("href"),c=c||{},h=f.attr("data-preload-options");switch(h&&(h=ExpressApp.Helper.JSON.ParseFromString(h)),c=h||c,f.attr("data-preload")){case"true":g=f;break;case"before":g=f,c=$.extend(c,{left:g.position().left-55,top:g.position().top+parseInt(g.css("margin-top")||0)+Math.floor((g[0].offsetHeight-45)/2)});break;case"after":g=f,c=$.extend(c,{left:g.position().left+g[0].offsetWidth+10,top:g.position().top+parseInt(g.css("margin-top")||0)+Math.floor((g[0].offsetHeight-45)/2)});break;case void 0:break;default:g=$(f.attr("data-preload")).length?$(f.attr("data-preload")):f.parent()}null!==g&&ExpressApp.Preload.Start(g,c),$.get(a,function(a){return d&&e.is(":visible")&&e.bind("reveal:closed.reveal",function(){e.empty().html(a).reveal()}),e.empty().html(a).reveal()}).complete(function(){null!==g&&ExpressApp.Preload.Stop(g)})},Show:function(a){var b=2==$(".reveal-dynamic").length,c=b?$(".reveal-dynamic:hidden").last():$("<div>").addClass("reveal-modal reveal-dynamic").appendTo("body");return b&&c.is(":visible")&&c.bind("reveal:closed.reveal",function(){c.empty().html(a).reveal()}),c.empty().html(a).reveal()}},Validator:{rules:{},errors:{},Bind:function(a,b){var c=this;this.rules=b||this.rules,$(a).submit(function(){return $(".has-error",$(this)).removeClass("has-error"),c.errors={},c.Validate()})},Validate:function(){for(var a in this.rules)if(this.rules.hasOwnProperty(a))for(var b in this.rules[a])this.rules[a].hasOwnProperty(b)&&this._methods[b]&&this._methods[b].apply(this,[a,this.rules[a][b]]);return!ExpressApp.Helper.JSON.GetLength(this.errors)},_methods:{required:function(a,b){var c={};"object"==typeof b&&(c=b,b=c.message),$(a).next(".error-message").remove(),"function"==typeof c.error&&c.error.apply(this,[a,b])||$(a).length&&""!=$(a).val()&&"function"!=typeof c.error||("string"==typeof c.error?$(c.error).html(b):($(a).parent().addClass("has-error"),$(a).after('<span class="error-message">'+b+"</span>")),this.errors[a]=b)}}},Social:{urls:{mailto:"mailto:?subject=Dailyexpress%20-%20interesting%20article&amp;body=You%20might%20be%20interested%20in%20this%20gallery:%20{URL}",addthis:"https://www.addthis.com/bookmark.php?v=300&pubid=netro42&url={URL}"},Facebook:function(){!function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_GB/all.js#xfbml=1",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk")},Twitter:function(){window.twttr=function(a,b,c){var d,e,f=a.getElementsByTagName(b)[0];if(!a.getElementById(c))return e=a.createElement(b),e.id=c,e.src="//platform.twitter.com/widgets.js",f.parentNode.insertBefore(e,f),window.twttr||(d={_e:[],ready:function(a){d._e.push(a)}})}(document,"script","twitter-wjs")},GooglePlus:function(){window.___gcfg={lang:"en-GB"},function(){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="//apis.google.com/js/plusone.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}()},AddThis:function(a){addthis.button(".article-share"),a&&addthis.button(".share-this")}},ComScore:{Track:function(a){self.COMSCORE&&COMSCORE.beacon(a),$.ajax({type:"GET",url:"/gcom/comscore.json",cache:!1})}},Parsely:{TrackDynamicContent:function(a,b,c,d){c=c||"Undefined",d=d||1,b=b||location.href,window.PARSELY&&PARSELY.beacon&&PARSELY.beacon.trackPageView({url:a,urlref:b,js:1,action_name:c})}},DataLayer:{TrackEvent:function(a){switch(a.events.event){case"article_impressions":(window.utag_add_event||function(){})({call_type:"event",events:{category:"Article",action:"Display Article",event:"article_impressions"},listing:a.listing});break;case"article_click":(window.utag_add_event||function(){})({call_type:"event",events:a.events,article:a.article});break;case"login_popup":case"registration_popup":case"login_successful":(window.utag_add_event||function(){})({call_type:"event",events:a.events});break;default:(window.utag_add_event||function(){})({call_type:"event",events:{category:"User Navigation",action:"Navigation Click",event:a.events.event},navigation:{name:a.navigation.name}})}}},GoogleAnalytics:{TrackPageView:function(a){"object"==typeof _gaq&&_gaq.push(["_trackPageview"],a),"function"==typeof ga&&(""==GA_PREPEND?ga("send","pageview",a):ga("send",{hitType:"pageview",location:window.location.href,page:a,title:GA_PREPEND+document.title}))},TrackCustomEvent:function(a,b,c,d){"object"==typeof window._gaq&&_gaq.push(["_trackEvent",a,b,c,d]),"function"==typeof window.ga&&ga("send","event",a,b,c,d)},TrackEvent:function(a,b,c){if("object"==typeof _gaq&&_gaq.push(["_trackEvent",a,"click",b]),"function"==typeof ga&&ga("send","event",a,"click",b),void 0===c)switch(a){case"offsite":(window.utag_add_event||function(){})({call_type:"event",events:{category:"Outbound",action:"Outbound Click",event:"outbound_click"},outbound:{name:b}});break;case"FootballWidget":(window.utag_add_event||function(){})({call_type:"event",events:{category:"FootballWidget",action:"Football Widget Click",event:"football_widget_click"},football_team:{name:b}});break;case"CRM - Competitions":(window.utag_add_event||function(){})({call_type:"event",events:{category:"CRM - Competitions",action:"CRM - Competitions Click",event:"crm_competition_click"},outbound:{name:b}});break;case"Most Read Stories":case"Latest News":case"Related Articles":}},TrackPushNotifications:function(a){"object"==typeof _gaq&&_gaq.push(["_trackEvent","Push Notification",a?"enable":"block"]),"function"==typeof ga&&ga("send","event","Push Notification",a?"enable":"block")},TrackArticleLength:function(a){a=parseInt(a),"object"==typeof _gaq&&_gaq.push(["_trackEvent","Scroll Depth","Article Length",a]),"function"==typeof ga&&ga("send","event","Scroll Depth","Article Length",a)},TrackFacebook:function(){window.fbAsyncInit=function(){FB.Event.subscribe("edge.create",function(a){"object"==typeof _gaq&&_gaq.push(["_trackSocial","facebook","like",a]),"function"==typeof ga&&ga("send","social","facebook","like",a)})}},TrackTwitter:function(){twttr.ready(function(a){a.events.bind("tweet",ExpressApp.GoogleAnalytics._trackTwitter)})},_trackTwitter:function(a){if(a){var b;a.target&&"IFRAME"==a.target.nodeName&&(opt_target=extractParamFromUri(a.target.src,"url")),"object"==typeof _gaq&&_gaq.push(["_trackSocial","twitter","tweet",b]),"function"==typeof ga&&ga("send","social","twitter","tweet",b)}}},ImageSwap:{Init:function(){$(document).ready(function(){ExpressApp.ImageSwap.Picturefill("img.swap:in-viewport")}),$(window).on("resize",function(){$("img.swap").removeClass("swapped-image"),ExpressApp.ImageSwap.Picturefill("img.swap:in-viewport")}),$(window).on("scroll",function(){ExpressApp.ImageSwap.Picturefill("img.swap:not(.swapped-image):in-viewport")})},Picturefill:function(a){$(a).each(function(a){var b=$(this),c=b.data(),d=[];if(ie8||ie7)d.push(c.src1);else for(var a=1;a<=c.imgcount;a++)(!c["media"+a]||window.matchMedia&&window.matchMedia(c["media"+a]).matches)&&d.push(c["src"+a]);d.length&&(this.onload=function(){b.removeClass("swap-original").addClass("swapped-image")},this.onerror=function(){b.removeClass("swap-original").addClass("swapped-image not-loaded")},b.attr("src",d.pop()))})}},ImageLazyLoad:function(){var a="lazyimageloaded";$(window).bind("scroll",function(){$("img.lazy:in-viewport").each(function(){var b=$(this);this.onload=function(){b.fadeIn(),b.removeClass("lazy").addClass("loaded"),$(window).trigger(a,b)},this.onerror=function(){b.removeClass("lazy").addClass("not-loaded")},b.attr("src",b.attr("data-src"))})}).scroll()},ResponsiveIframe:function(a){if(!$(a).parents(".pure-iframe").length){var b=[];$(a).each(function(a){$(this).css("width","auto !important"),b[a]={frame:this,ratio:$(this).width()/$(this).height(),src:$(this).attr("src")}}),$(window).resize(function(){$.each(b,function(){this.src&&!this.src.match(/engagesciences/gi)&&($(this.frame).css("width","100%"),this.src.match(/constituencies/gi)||$(this.frame).height($(this.frame).width()/this.ratio))})}),$(window).resize()}},Homepage:{AlignUnits:function(){for(var a="pure",b="box-container",c="min-height",d={TYPE_1:".after-portrait-block",TYPE_2:".after-big-story-block"},e=$('[data-mh-rh="group-custom-1"]'),f=e.length-1;f>=0;f--){var g=$(e[f]),h=d.TYPE_1,i=g.parents(h);i.length||(h=d.TYPE_2,i=g.parents(h));for(var j=[],k=f;k>=0;k--){var l=$(e[k]);l.parents(h).is(i)&&(j.push(l),e.splice(k,1))}if(j.length)switch(f-=j.length-1,h){case d.TYPE_1:for(var m=0,n=0;n<j.length;n++)j[n].outerHeight()>m&&(m=j[n].outerHeight());for(var n=0;n<j.length;n++)j[n].css(c,m);break;case d.TYPE_2:for(var o,p,q,n=j.length-1;n>=0;n--)j[n].hasClass(b)?q=j[n]:j[n].hasClass(a)?o=j[n]:p=j[n],j.splice(n,1);var r=o.outerHeight(!0)+p.outerHeight(!0),s=q.outerHeight(!0),t=Math.abs(r-s);if(r>s)q.css(c,q.height()-q.css("margin-bottom")+t);else if(s>r){var u=parseInt(p.css("margin-bottom").replace("px",""),10);p.css("margin-bottom",u+t)}}}}}}),ExpressApp.Header=function(a){this.options={triggers:{search:null,user:null,burgerOpen:null,burgerClose:null,miniLogin:null},elements:{search:null,burgerMenu:null,headerShell:null,headerMini:null},miniBlocked:!1},$.extend(this.options,a);var b=this;this.Init=function(){b.Listener()},this.Search={visible:!1,Show:function(){$(b.options.elements.search).slideDown("200","swing",function(){b.Search.visible=!0}),$("#searchTrigger").addClass("focused")},Hide:function(){$(b.options.elements.search).slideUp("200","swing"),$("#searchTrigger").removeClass("focused"),b.Search.visible=!1}},this.Listener=function(){$(b.options.triggers.search).on("click",function(){b.Search.visible?b.Search.Hide():b.Search.Show()}),$("body").on("click",function(a){b.Search.visible&&($(a.target).closest(".search").length||b.Search.Hide())}),$(b.options.triggers.burgerOpen).on("click",function(a){b.Burger.Open(a)}),$(b.options.triggers.burgerClose).on("click",function(){b.Burger.Close()}),$(document).ready(function(){$(window).scroll(function(){$(b.options.elements.headerShell).outerHeight(!0)<=$(window).scrollTop()?b.Mini.Show():b.Mini.Hide()})}),$(b.options.triggers.miniLogin).on("click",function(){$("#nse-widget").data("loggedin")||ExpressApp.GigyaExpresso.UserArea.showLogin()})},this.Burger={OverrideMarginValue:0,Open:function(){$(b.options.elements.burgerMenu).is(":visible")||($(b.options.elements.burgerMenu).slideDown(500),$(b.options.elements.headerMini).addClass("burgerOpened"))},Close:function(){$(b.options.elements.burgerMenu).is(":visible")&&($(b.options.elements.burgerMenu).slideUp(500),$(b.options.elements.headerMini).removeClass("burgerOpened"))}},this.Mini={showAfter:500,interval:null,visible:!1,Show:function(){return b.Mini.visible?!1:(clearInterval(b.Mini.interval),void(b.Mini.interval=setInterval(function(){if(b.Mini.visible)return!1;for(;!b.Mini.Blocked();)if(!b.Mini.visible){$(b.options.elements.headerMini).slideDown(300),$(b.options.elements.burgerMenu).addClass("fromMini"),b.Mini.visible=!0;break}},b.Mini.showAfter)))},Hide:function(){clearInterval(b.Mini.interval),$(b.options.elements.headerMini).slideUp(300),$(b.options.elements.burgerMenu).removeClass("fromMini"),$(b.options.elements.mainContainer).css("margin-top","0px"),b.Mini.visible=!1},Blocked:function(a){return"undefined"!=typeof a&&(b.options.miniBlocked=a?!0:!1),b.options.miniBlocked}}},ExpressApp.Log("App.Spot declaration"),ExpressApp.Spot={spotApiReady:!1,gigyaSignedIn:!1,CheckRequirements:function(a){return ExpressApp.Log("!!uid && this.spotApiReady && this.gigyaSignedIn",!!a&&this.spotApiReady&&this.gigyaSignedIn),!!a&&this.spotApiReady&&this.gigyaSignedIn},StartSSO:function(a,b){ExpressApp.Log("Checking requirements"),this.CheckRequirements(a)?(ExpressApp.Log("All fine... Starting SSO for provider."),window.SPOTIM.startSSOForProvider({provider:"gigya",token:a}).then(function(a){"function"==typeof b&&b.call(this,a),ExpressApp.Log("logged in!",a)},function(a){"function"==typeof b&&b.call(this,a),ExpressApp.Log("sso failed, already logged in?",a)})):(ExpressApp.Log("SPOT API READY: ",this.spotApiReady),ExpressApp.Log("GIGYA USER SIGNED IN: ",this.gigyaSignedIn),ExpressApp.Log("GIGYA USER ID: ",a))}},ExpressApp.GigyaExpresso={loaded:!!window.Expresso,Load:function(a){if(ExpressApp.GigyaExpresso.loaded)"function"==typeof a&&a.apply(ExpressApp.GigyaExpresso);else if("undefined"!=typeof window.expressoScriptSrc){var b=document.createElement("script");b.type="text/javascript",b.src=window.expressoScriptSrc,b.async=!0,b.onload=function(){ExpressApp.GigyaExpresso.loaded=!0,"function"==typeof a&&a.apply(ExpressApp.GigyaExpresso)};var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}},UserArea:{windowname:null,showLogin:function(){$("#nse-widget .nse_login-link").click()}}},ExpressApp.Brightcove=function(a,b){var c=function(a,b){function c(){if(ExpressApp.Log("Checking videojs is available",void 0!==a),void 0!==a)for(var c in a.players)if(a.players.hasOwnProperty(c)){var e=a(c);if(ExpressApp.Log("Iterating over players",e),e.ioEventAttached)ExpressApp.Log("[IO]","video listener already attached");else{e.ioEventAttached=!0;var f=b(e.el()).find("video")[0];d(f,e)}}}function d(a,c){ExpressApp.Log("[IO]","attaching loadedmetadata/loadstart event",c,a);var d=function(){ExpressApp.Log("[IO]","adding io config required attributes",c,a),b(a).attr("data-io-video-title",b.trim(this.mediainfo.name))};c.on("loadedmetadata",d),c.on("loadstart",d)}return c(),{attachConfig:d,restart:c}}(a,b);return{IO:c}}(window.videojs,$),ExpressApp.EmbededGalleryV2={options:{triggers:{carousel:null,photo:null,topNavi:null,photoActions:null},elements:{counter:null,gallery:null,carousel:null,currentPhoto:null},resizeRatio:null,uniqueId:null,modal:null,stop:!1,maxHeight:471,minHeight:600,miniSlideshowIntervalTime:4e3,oneThumbWidth:85,url:null,followRelatedGalleriesHref:!1,openOnInit:!0,data:null,counter:1,gallery_position:1,afterImageChange:function(){},beforeImageChange:function(){}},miniSlideshowPlaying:!1,isSwiping:!1,miniSlideshowInterval:null,galleryTitle:null,galleryId:null,gallerySectionId:null,galleryMetaTitle:null,currentImage:1,currentImageId:null,currentThumbContainerWidth:null,lastAction:null,prevImage:1,clickCounter:0,slideCounter:0,startThumbScrollAt:0,totalImages:1,elementsShurnk:!1,hasReachedTheEnd:!1,preloadedImages:Array(),sliderLocked:!1,pauseVideos:function(){if($.fn.stickyPlayer){if(this.$stuckPlayer=null,!videojs)return!1;for(var a in videojs.players)if(videojs.players.hasOwnProperty(a)){ExpressApp.Log("Player",videojs.players[a],a);var b=videojs.players[a];b.pause(),b.ima3&&b.ima3.currentAd&&b.ima3.adsManager&&b.ima3.adPlayer.pause(),$(".video-js.ns-player-stuck").length&&(this.$stuckPlayer=$(".video-js.ns-player-stuck video"),this.$stuckPlayer.stickyPlayer("unstick"))}}},restoreVideos:function(){this.$stuckPlayer&&this.$stuckPlayer.stickyPlayer("stick")},Prepare:function(a,b,c,d){$.extend(this.options,d),c.thumbnails&&$('[data-gallery="'+b+'"] [data-nav]').html(tmpl("thumb-item",{thumbs:c.thumbnails})),ExpressApp.EmbededGalleryV2.AddSocialButtons($('[data-gallery="'+b+'"]'),$('[data-gallery="'+b+'"] [data-social-shares]').attr("id")),ExpressApp.jsonGalleries[b]=c,$('[data-gallery="'+b+'"] [data-social-shares]').on("click",function(a){a.stopImmediatePropagation()}),$('[data-gallery="'+b+'"] .galleryMainPhoto').find(".prev, .next").on("click",function(){var a=$(this).hasClass("next");$('[data-gallery="'+b+'"]').one("gallery.opened",function(){a?ExpressApp.EmbededGalleryV2.NextImage(!0):ExpressApp.EmbededGalleryV2.PrevImage(!0)})}),$('[data-gallery="'+b+'"] .galleryCarousel').find(".jcarousel-item").on("click",function(){var a=$(this).index()+1;$('[data-gallery="'+b+'"]').one("gallery.opened",function(){ExpressApp.EmbededGalleryV2.SpecificImage(a,!0)})}),a.on("click",function(a){a.preventDefault(),ExpressApp.EmbededGalleryV2.InitiateV3(b)})},Initiate:function(a){$.extend(this.options,a),$("body").append('<div class="galleryv2Modal" id="galleryv2Modal"></div>'),this.options.openOnInit&&(ExpressApp.EmbededGalleryV2.OpenModal(),$(window).on("resize",ExpressApp.EmbededGalleryV2.ResizeFunctions))},InitiateV3:function(a){$("body").append('<div class="galleryv2Modal" id="galleryv2Modal"></div>'),this.options.openOnInit&&(ExpressApp.EmbededGalleryV2.OpenModalV3(a),$(window).on("resize",ExpressApp.EmbededGalleryV2.ResizeFunctions))},OpenModal:function(a){this.pauseVideos(),$("#galleryv2Modal").length||$('<div id="galleryv2Modal" class="galleryv2Modal"/>').appendTo($("body")),$("#galleryv2Modal").show(),GA_PREPEND="Embedded Gallery: ",$.ajax({url:this.options.url,data:this.options.data,success:function(b){$("#galleryv2Modal").html(b).show(),$(window).trigger("scroll"),$(window).resize(),$("body").css({position:"fixed",top:-1*$(window).scrollTop()}),ExpressApp.EmbededGalleryV2.SetTotalImages(),ExpressApp.EmbededGalleryV2.LoadMPU(),ExpressApp.EmbededGalleryV2.RealignCaption(),ExpressApp.EmbededGalleryV2.SetHeightOfAside(),ExpressApp.EmbededGalleryV2.SetHeightOfAdvertContainer(),ExpressApp.EmbededGalleryV2.SetHeightOfMainImageContainer(),ExpressApp.EmbededGalleryV2.SetWidthOfThumbContainer(),ExpressApp.EmbededGalleryV2.SetListeners(),ExpressApp.EmbededGalleryV2.AddSocialButtons(),ExpressApp.EmbededGalleryV2.AddMoreLinksToSummary(),ExpressApp.EmbededGalleryV2.PreloadImages(1),
ExpressApp.EmbededGalleryV2.PlaySlideShow(),window.setTimeout("ExpressApp.EmbededGalleryV2.GetRelatedGallery()",500),"function"==typeof a&&a()}})},OpenModalV3:function(a){this.pauseVideos(),$("#galleryv2Modal").length||$('<div id="galleryv2Modal" class="galleryv2Modal"/>').appendTo($("body")),$("#galleryv2Modal").show(),GA_PREPEND="Embedded Gallery: ",ExpressApp.jsonGalleries.hasOwnProperty(a)&&($("#galleryv2Modal").html(ExpressApp.jsonGalleries[a].gallery).show(),$(window).trigger("scroll"),$(window).resize(),$("body").css({position:"fixed",top:-1*$(window).scrollTop()}),ExpressApp.EmbededGalleryV2.SetTotalImages(),ExpressApp.EmbededGalleryV2.PreloadImages(1),ExpressApp.EmbededGalleryV2.RealignCaption(),ExpressApp.EmbededGalleryV2.SetHeightOfAside(),ExpressApp.EmbededGalleryV2.SetHeightOfAdvertContainer(),ExpressApp.EmbededGalleryV2.SetHeightOfMainImageContainer(),ExpressApp.EmbededGalleryV2.SetWidthOfThumbContainer(),ExpressApp.EmbededGalleryV2.SetListeners(),ExpressApp.EmbededGalleryV2.AddSocialButtons(),ExpressApp.EmbededGalleryV2.AddMoreLinksToSummary(),ExpressApp.EmbededGalleryV2.LoadMPU(),ExpressApp.EmbededGalleryV2.PlaySlideShow(),window.setTimeout("ExpressApp.EmbededGalleryV2.GetRelatedGallery()",500),$('[data-gallery="'+a+'"]').trigger($.Event("gallery.opened",{id:a})))},EmptyModal:function(){$("#galleryv2Modal").html(""),ExpressApp.EmbededGalleryV2.ResetModalVariables()},DestroyModal:function(){$(document).trigger("gallery.beforeclose"),$(window).off("resize",ExpressApp.EmbededGalleryV2.ResizeFunctions),GA_PREPEND="",$("#galleryv2Modal").remove();var a=-1*parseFloat($("body").css("top"));$("body").css({position:"",top:""}),console.info(a),$(window).scrollTop(a),this.restoreVideos(),ExpressApp.EmbededGalleryV2.ResetModalVariables(),$(document).trigger("gallery.afterclose")},ResetModalVariables:function(){ExpressApp.EmbededGalleryV2.prevImage=1,ExpressApp.EmbededGalleryV2.totalImages=1,ExpressApp.EmbededGalleryV2.currentImage=1,ExpressApp.EmbededGalleryV2.clickCounter=0,ExpressApp.EmbededGalleryV2.slideCounter=0,ExpressApp.EmbededGalleryV2.startThumbScrollAt=0,ExpressApp.EmbededGalleryV2.galleryId=null,ExpressApp.EmbededGalleryV2.gallerySectionId=null,ExpressApp.EmbededGalleryV2.currentThumbContainerWidth=null,ExpressApp.EmbededGalleryV2.galleryMetaTitle=null,ExpressApp.EmbededGalleryV2.preloadedImages=Array(),window.clearInterval(ExpressApp.EmbededGalleryV2.miniSlideshowInterval),ExpressApp.EmbededGalleryV2.miniSlideshowInterval=null,ExpressApp.EmbededGalleryV2.miniSlideshowPlaying=!1},RealignCaption:function(){$("#maingalleryimage figcaption").css({marginLeft:$("#maingalleryimage div").css("marginLeft")+"px"})},ResizeFunctions:function(){try{ExpressApp.EmbededGalleryV2.RealignCaption(),ExpressApp.EmbededGalleryV2.SetHeightOfAside(),ExpressApp.EmbededGalleryV2.SetHeightOfAdvertContainer(),ExpressApp.EmbededGalleryV2.SetHeightOfMainImageContainer(),ExpressApp.EmbededGalleryV2.MiddleTheActiveThumbInContainer()}catch(a){console&&console.warn(a)}},SetHeightOfAside:function(){$(".slideshowv2 figure aside").height($(".slideshowv2").height()+36)},MiddleTheActiveThumbInContainer:function(){if(ExpressApp.EmbededGalleryV2.currentThumbContainerWidth!=$("#galleryCarouselShell_").width()){{var a=$("#galleryCarouselShell_").width(),b=$("#galleryCarousel_").width(),c=a/2+this.options.oneThumbWidth;$("#galleryCarousel_ li.active").position().left}if(maxScroll=0,minScroll=a-b,ExpressApp.EmbededGalleryV2.startThumbScrollAt=Math.max(0,Math.ceil(c/this.options.oneThumbWidth)),minScroll<=0){var d=-1*this.options.oneThumbWidth*(this.currentImage-ExpressApp.EmbededGalleryV2.startThumbScrollAt+1);$(".galleryCarouselShell ul","#galleryv2Modal").css({marginLeft:Math.max(minScroll,Math.min(maxScroll,d))+"px"})}ExpressApp.EmbededGalleryV2.currentThumbContainerWidth=$("#galleryCarouselShell_").width()}},SetHeightOfMainImageContainer:function(a){return headerheight=$(".op-slideshow > header").height(),slideshowNavheight=$("#slideshowNav").height(),galleryCarouselShell_height=$("#galleryCarouselShell_").height(),imgcontainerheight=$(".imagecontainer img").height(),photodatacontainer=$(".photodatacontainer").height()+parseFloat($(".photodatacontainer").css("padding-top"))+parseFloat($(".photodatacontainer").css("padding-bottom")),remainder=$(window).height()-headerheight-slideshowNavheight-galleryCarouselShell_height,$("#maingalleryimage").height(remainder),void 0!==a||ExpressApp.EmbededGalleryV2._imgLoaded?(imgrealheight=$(".imagecontainer img")[0].naturalHeight,imgcontainerheightsetting="",imgrealheight+photodatacontainer>remainder&&(imgcontainerheightsetting=remainder-photodatacontainer+"px"),void $(".imagecontainer img").css("max-height",imgcontainerheightsetting)):!1},SetWidthOfThumbContainer:function(){$(".galleryCarouselShell ul","#galleryv2Modal").width(this.options.oneThumbWidth*this.totalImages+8)},SetHeightOfAdvertContainer:function(){var a=$(".op-slideshow").width();if(769>a){ExpressApp.EmbededGalleryV2.elementsShurnk=!0;var b=$(".slideshowv2 aside").width(),c=a-b-30;$(".op-slideshow header").width(c),$("#slideshowNav").width(c+9),$("#galleryCarouselShell_").width(c),percentagescale=b/300,$(".slideshowadvert > div").css({transform:"scale("+percentagescale+", "+percentagescale+")",transformOrigin:"0 0"}),$("#galleryCarouselShell_").width(a),$(".slideshowadvert").height(percentagescale*$(".slideshowadvert > div").height()),$(".slideshowv2 figure aside").height($(".slideshowv2").height()-90)}else if(ExpressApp.EmbededGalleryV2.elementsShurnk){var b=$(".slideshowv2 aside").width(),c=a-321;$(".op-slideshow header").css({width:""}),$("#slideshowNav").css({width:""}),$("#galleryCarouselShell_").css({width:""}),$(".slideshowadvert > div").css({transform:"scale(1, 1)",transformOrigin:"0 0"}),$(".slideshowadvert").height(percentagescale*$(".slideshowadvert > div").height()),$(".slideshowv2 figure aside").height($(".slideshowv2").height()-90)}},PlaySlideShow:function(a){a||ExpressApp.EmbededGalleryV2.TogglePlayState(!1),clearInterval(ExpressApp.EmbededGalleryV2.miniSlideshowInterval),ExpressApp.EmbededGalleryV2.miniSlideshowInterval=window.setInterval("ExpressApp.EmbededGalleryV2.NextImage()",ExpressApp.EmbededGalleryV2.options.miniSlideshowIntervalTime)},TogglePlayState:function(a){ExpressApp.EmbededGalleryV2.miniSlideshowPlaying===!0?(window.clearInterval(this.miniSlideshowInterval),ExpressApp.EmbededGalleryV2.miniSlideshowInterval=null,$('.play_slideshow [data-button="miniGallerySlideshow"]').text("Play Slide show").removeClass("pause").addClass("play").data("state","paused"),ExpressApp.EmbededGalleryV2.miniSlideshowPlaying=!1):(a===!0&&ExpressApp.EmbededGalleryV2.PlaySlideShow(),$('.play_slideshow [data-button="miniGallerySlideshow"]').text("Pause Slide show").removeClass("play").addClass("pause"),ExpressApp.EmbededGalleryV2.miniSlideshowPlaying=!0)},AddSocialButtons:function(a,b){a=a||$(".slideshowv2"),b=b||"social_buttons";{var c=a.data("gallerylink"),d=a.data("galleryimg"),e=a.data("gallerydesc"),f=a.data("gallerytitle"),g=a.data("gallerymetatitle"),h=a.data("gallerysectionid"),i=a.data("galleryid");a.data("imageid")}this.galleryTitle=f,$('[property="og:url"]').attr("content",c),this.galleryMetaTitle=g,this.gallerySectionId=h,this.galleryId=i;var j=new gigya.socialize.UserAction;j.setUserMessage("This is the user message"),j.setTitle(f),j.setLinkBack(c),j.setDescription(e),j.addActionLink("See the gallery",c),j.addMediaItem({type:"image",src:d,href:c}),gigya.socialize.showShareBarUI({containerID:b,shareButtons:[{provider:"twitter",iconImgUp:ExpressApp.Config.webrootImg+"page/icons/share/twitter.png"},{provider:"facebook",iconImgUp:ExpressApp.Config.webrootImg+"page/icons/share/facebook.png"},{provider:"googleplus",iconImgUp:ExpressApp.Config.webrootImg+"page/icons/share/google.png"},{provider:"pinterest",iconImgUp:ExpressApp.Config.webrootImg+"page/icons/share/pinterest.png"}],userAction:j,action:"recommend",showCounts:"none",noButtonBorders:!0,showTooltips:!1,iconsOnly:!0,onSendDone:function(){ExpressApp.GoogleAnalytics.TrackEvent("social","share",f)},onShareButtonClicked:function(a){switch(a.shareItem.provider){case"googleplus":ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed google+");break;case"twitter":ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed twitter");break;case"facebook":ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed facebook");break;case"pinterest":ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed pinterest")}ExpressApp.GoogleAnalytics.TrackEvent("social","intent",f)}})},TrackGalleryEvents:function(a){ExpressApp.EmbededGalleryV2.lastAction=a,this.galleryTitle||(this.galleryTitle=$(".slideshowv2").data("galleryTitle")),ExpressApp.EmbededGalleryV2.DataLayerEvent("click",{image_id:ExpressApp.EmbededGalleryV2.currentImageId,image_name:$(".galleryCarouselShell ul li[data-picture-position="+ExpressApp.EmbededGalleryV2.currentImage+"]","#galleryv2Modal").find("a img").attr("title"),image_position:ExpressApp.EmbededGalleryV2.currentImage}),ExpressApp.GoogleAnalytics.TrackEvent("Gallery embed",a,this.galleryTitle)},UpdateTrackingDetails:function(a){var b=window.location.href.split("?");if(void 0!==b[1])var c="?"+b[1];else c="";var d=b[0].split("/"),e=(document.title.split(" | "),d[0]+"//"+d[2]+"/"+d[3]+"/"+d[4]+"/"+d[5]+"/"+d[6]),f=e+"/"+this.currentImageId+c;window.ga&&(ga("set","dimension8",f),ga("set","dimension9",1)),ExpressApp.GoogleAnalytics.TrackPageView(f),a&&ExpressApp.ComScore.Track({c1:"2",c2:"12961652"}),ExpressApp.Parsely.TrackDynamicContent(f,document.referrer,"Gallery - load more"),"undefined"!=typeof twttr&&"undefined"!=typeof twttr.widgets&&twttr.widgets.load()},DataLayerEvent:function(a,b){var c={id:ExpressApp.EmbededGalleryV2.galleryId,name:ExpressApp.EmbededGalleryV2.galleryTitle,position:ExpressApp.EmbededGalleryV2.options.gallery_position,image_id:b.image_id,image_name:b.image_name,image_position:b.image_position,ad_placement:"Left",action_type:ExpressApp.EmbededGalleryV2.lastAction,autoplay:ExpressApp.EmbededGalleryV2.miniSlideshowPlaying};"page"==a?(window.utag_add_event||function(){})({call_type:"event",events:{category:"Gallery",action:"Display Gallery",event:"gallery_impressions"},gallery:c,ads:window.utag_data.ads,ad_slots:window.utag_data.ad_slots}):"click"==a&&(window.utag_add_event||function(){})({call_type:"event",events:{category:"Gallery",action:"Click Gallery Image",event:"clicked_gallery_image"},gallery:c,ad_slots:window.utag_data.ad_slots})},SetListeners:function(){$(".galleryCarouselShell li a","#galleryv2Modal").on("click",function(a){a.preventDefault(),ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed thumbnail click"),ExpressApp.EmbededGalleryV2.SpecificImage($(this).parent().attr("data-picture-position"),!0)}),$("#maingalleryimage a.prev").on("click",function(a){a.preventDefault(),ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed previous arrow"),ExpressApp.EmbededGalleryV2.PrevImage(!0)}),$("#maingalleryimage a.next").on("click",function(a){a.preventDefault(),ExpressApp.EmbededGalleryV2.clickCounter=1,ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed next arrow"),ExpressApp.EmbededGalleryV2.NextImage(!0)}),$("#maingalleryimage").off("click","img").on("click","img",function(a){a.preventDefault(),ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed main image click"),ExpressApp.EmbededGalleryV2.NextImage(!0),ExpressApp.EmbededGalleryV2.PlaySlideShow(ExpressApp.EmbededGalleryV2.miniSlideshowPlaying)}),$(".op-slideshow").on("click","details span",function(a){var b=$(this).closest("details");a.preventDefault(),ExpressApp.Supports.details()?b[0].open=!b[0].open:b.attr("open")?b.attr("open",!1):b.attr("open",!0),$(window).resize()}),$("#maingalleryimage div").swipe({swipeLeft:function(){ExpressApp.EmbededGalleryV2.isSwiping||(ExpressApp.EmbededGalleryV2.isSwiping=!0,ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed swipe to next"),ExpressApp.EmbededGalleryV2.NextImage(!0))},swipeRight:function(){ExpressApp.EmbededGalleryV2.isSwiping||(ExpressApp.EmbededGalleryV2.isSwiping=!0,ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed swipe to previous"),ExpressApp.EmbededGalleryV2.PrevImage(!0))},swipeStatus:function(a,b,c){"end"==b&&"left"==c&&ExpressApp.EmbededGalleryV2.PlaySlideShow(ExpressApp.EmbededGalleryV2.miniSlideshowPlaying)}}),$("#slideshowNav .galleryExpandedCollapse").on("click",function(a){a.preventDefault(),ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed close"),ExpressApp.EmbededGalleryV2.DestroyModal()}),$('.play_slideshow [data-button="miniGallerySlideshow"]').on("click",function(a){a.preventDefault(),$('.play_slideshow [data-button="miniGallerySlideshow"]').hasClass("play")?(ExpressApp.EmbededGalleryV2.NextImage(!0),ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed play button")):(ExpressApp.EmbededGalleryV2.TogglePlayState(!0),ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed pause button"))}),$("#maingalleryimage figcaption details > span").on("click",function(){$(this).parent().removeAttr("open")});var a=function(a){switch(a.which){case 39:ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed keyboard next pressed"),ExpressApp.EmbededGalleryV2.NextImage(!0);break;case 37:ExpressApp.EmbededGalleryV2.TrackGalleryEvents("embed keyboard previous pressed"),ExpressApp.EmbededGalleryV2.PrevImage(!0);break;case 32:$('.play_slideshow [data-button="miniGallerySlideshow"]').click();break;case 27:$("#slideshowNav .galleryExpandedCollapse").click()}};$(document).off("keydown",a).on("keydown",a)},ScrollThumbs:function(a){var b=this,c=a;("forward"==a||"back"==a)&&(c=b.currentImage),widthofthumbnav=$("#galleryCarouselShell_","#galleryv2Modal").width(),widthofthumblist=$("#galleryCarousel_","#galleryv2Modal").width();var d=parseInt($(".galleryCarouselShell ul","#galleryv2Modal").css("marginLeft").replace("px",""),10);maxScroll=0,minScroll=widthofthumbnav-widthofthumblist;var e=widthofthumbnav/2-2*this.options.oneThumbWidth,f=$('#galleryCarousel_ li[data-picture-position="'+c+'"]',"#galleryv2Modal").position().left;if(minScroll<=0&&!(widthofthumbnav>widthofthumblist+d||e>f&&!(f>e+this.options.oneThumbWidth))){switch(a){case"forward":$(".galleryCarouselShell ul","#galleryv2Modal").animate({marginLeft:d+this.options.oneThumbWidth+"px"},500,function(){$(".galleryCarouselShell ul li.active","#galleryv2Modal").removeClass("active").siblings('li[data-picture-position="'+c+'"]').addClass("active"),ExpressApp.EmbededGalleryV2.CheckForDisabledNav()});break;case"back":$(".galleryCarouselShell ul","#galleryv2Modal").animate({marginLeft:d-this.options.oneThumbWidth+"px"},500,function(){$(".galleryCarouselShell ul li.active","#galleryv2Modal").removeClass("active").siblings('li[data-picture-position="'+c+'"]').addClass("active"),ExpressApp.EmbededGalleryV2.CheckForDisabledNav()});break;default:0===ExpressApp.EmbededGalleryV2.startThumbScrollAt&&(ExpressApp.EmbededGalleryV2.startThumbScrollAt=c);var g=-1*this.options.oneThumbWidth*(c-ExpressApp.EmbededGalleryV2.startThumbScrollAt+1);$(".galleryCarouselShell ul","#galleryv2Modal").animate({marginLeft:Math.max(minScroll,Math.min(maxScroll,g))+"px"},500,function(){$(".galleryCarouselShell ul li.active","#galleryv2Modal").removeClass("active").siblings('li[data-picture-position="'+c+'"]').addClass("active"),ExpressApp.EmbededGalleryV2.CheckForDisabledNav()})}$(window).trigger("scroll")}else if(minScroll<=0&&e>=f){0===ExpressApp.EmbededGalleryV2.startThumbScrollAt&&(ExpressApp.EmbededGalleryV2.startThumbScrollAt=c);var g=-1*this.options.oneThumbWidth*(c-ExpressApp.EmbededGalleryV2.startThumbScrollAt+1);e>=f&&0==d&&(g=0),$(".galleryCarouselShell ul","#galleryv2Modal").animate({marginLeft:Math.max(minScroll,Math.min(maxScroll,g))+"px"},500,function(){$(".galleryCarouselShell ul li.active","#galleryv2Modal").removeClass("active"),$('.galleryCarouselShell ul li[data-picture-position="'+c+'"]',"#galleryv2Modal").addClass("active"),ExpressApp.EmbededGalleryV2.CheckForDisabledNav()})}else this.prevImage==this.totalImages&&1==c?$(".galleryCarouselShell ul","#galleryv2Modal").animate({marginLeft:"0px"},500,function(){$(".galleryCarouselShell ul li.active","#galleryv2Modal").removeClass("active"),$('.galleryCarouselShell ul li[data-picture-position="'+c+'"]',"#galleryv2Modal").addClass("active"),ExpressApp.EmbededGalleryV2.CheckForDisabledNav()}):($('li[data-picture-position="'+b.prevImage+'"]',"#galleryv2Modal").removeClass("active").siblings('li[data-picture-position="'+c+'"]').addClass("active"),ExpressApp.EmbededGalleryV2.CheckForDisabledNav());$(window).scroll()},CheckForDisabledNav:function(){},NextImage:function(a){if(ExpressApp.EmbededGalleryV2.sliderLocked)return!1;ExpressApp.EmbededGalleryV2.sliderLocked=!0,this.PlaySlideShow(ExpressApp.EmbededGalleryV2.miniSlideshowPlaying),this.slideCounter++,this.prevImage=this.currentImage,this.currentImage=ExpressApp.EmbededGalleryV2.CheckValidPosition(this.currentImage+1),this.ScrollThumbs(this.currentImage),ExpressApp.EmbededGalleryV2.clickCounter=0;var b=$(".galleryCarouselShell ul li[data-picture-position="+this.currentImage+"]","#galleryv2Modal");this.ChangeImageCounter(),this.UpdateImageData(this.BuildGalleryImageURL(b),b.find("a img").attr("title"),b.data("picture-credit"),this.currentImage,b.data("picture-id"),!!a)},PrevImage:function(a){if(ExpressApp.EmbededGalleryV2.sliderLocked)return!1;ExpressApp.EmbededGalleryV2.sliderLocked=!0,this.miniSlideshowPlaying=!0,this.TogglePlayState(),this.slideCounter++,this.prevImage=this.currentImage,this.currentImage=this.CheckValidPosition(this.currentImage-1),this.ScrollThumbs(this.currentImage);var b=$(".galleryCarouselShell ul li[data-picture-position="+this.currentImage+"]","#galleryv2Modal");this.ChangeImageCounter(),this.UpdateImageData(this.BuildGalleryImageURL(b),b.find("a img").attr("title"),b.data("picture-credit"),this.currentImage,b.data("picture-id"),!!a)},SpecificImage:function(a,b){if(ExpressApp.EmbededGalleryV2.sliderLocked)return!1;ExpressApp.EmbededGalleryV2.sliderLocked=!0,this.PlaySlideShow(ExpressApp.EmbededGalleryV2.miniSlideshowPlaying),this.slideCounter++,this.prevImage=this.currentImage,a=parseInt(a,10),this.currentImage=this.CheckValidPosition(a),this.ScrollThumbs(a);var c=$(".galleryCarouselShell ul li[data-picture-position="+this.currentImage+"]","#galleryv2Modal");this.ChangeImageCounter(),this.UpdateImageData(this.BuildGalleryImageURL(c),c.find("a img").attr("title"),c.data("picture-credit"),a,c.data("picture-id"),!!b)},UpdateImageData:function(a,b,c,d,e,f){ExpressApp.EmbededGalleryV2._imgLoaded=!1;var g=$.Deferred(),h=g.promise(),i=$("#maingalleryimage div img"),j=i.clone().hide();j[0].onload=function(a){a.userAction=!!f,ExpressApp.EmbededGalleryV2._imgLoaded=!0,g.resolve(this,a)},j[0].onerror=function(a){a.userAction=!!f,i.remove(),ExpressApp.EmbededGalleryV2.sliderLocked=!1,g.resolve(this,a)},i.parent().append(j),j.attr("src",a).attr("alt",b),i.fadeOut(200,function(){i.remove(),j.fadeIn(200,function(){h.then(function(a,b){$(".imagecontainer i").text(c).show(),ExpressApp.EmbededGalleryV2.SetHeightOfMainImageContainer(b),ExpressApp.EmbededGalleryV2.sliderLocked=!1})})}),$(".imagecontainer i").hide(),h.then(function(a,c){$("#maingalleryimage figcaption").html(ExpressApp.EmbededGalleryV2.Truncate(b,120)).find("details > span").on("click",function(){$(this).parent().removeAttr("open")}),ExpressApp.EmbededGalleryV2.currentImageId=e,ExpressApp.EmbededGalleryV2.AddMoreLinksToSummary(),$(window).resize(),ExpressApp.EmbededGalleryV2.DataLayerEvent("page",{image_id:e,image_name:b,image_position:d}),ExpressApp.EmbededGalleryV2.UpdateTrackingDetails(c.userAction),ExpressApp.EmbededGalleryV2.CheckIfWeNeedToRefreshMPU(),ExpressApp.EmbededGalleryV2.isSwiping=!1,ExpressApp.EmbededGalleryV2.PreloadImages(d)})},PreloadImages:function(){var a=$(".galleryCarouselShell ul li[data-picture-position="+this.currentImage+"]","#galleryv2Modal").nextAll().slice(0,5);a.each(function(){var a=ExpressApp.EmbededGalleryV2.BuildGalleryImageURL(this);if(-1===$.inArray(a,ExpressApp.EmbededGalleryV2.preloadedImages)){var b=document.createElement("IMG");b.src=a,ExpressApp.EmbededGalleryV2.preloadedImages.push(a)}})},CheckValidPosition:function(a){return 0>=a?this.totalImages:a>this.totalImages?1:a},ChangeImageCounter:function(){$(".photodatacontainer span i").text(this.currentImage)},PhotoLoaded:function(a){var b=a.height,c=a.width;b>this.options.maxHeight&&(r=this.options.maxHeight/b,b=this.options.maxHeight,c=r*a.width),$(a).attr("style","margin:-"+b/2+"px 0 0 -"+c/2+"px"),$("#maingalleryimage figure").fadeIn(100)},BuildGalleryImageURL:function(a){return ExpressApp.Config.webrootImgDynamic+"galleries/"+$(a).data("picture-largestimage")+"/"+($(a).data("picture-name")?$(a).data("picture-name")+"-"+$(a).data("picture-id"):$(a).data("picture-id"))+".jpg"},BuildGalleryCoverImageURL:function(a){return a.Gallery.cover_id?ExpressApp.Config.webrootImgDynamic+"galleries/covers/"+a.Gallery.id+"/300x200/"+a.Gallery.cover_file_name:ExpressApp.Config.webrootImgDynamic+"galleries/300x200/"+a.Photo.id+".jpg"},SetTotalImages:function(){this.totalImages=$(".galleryCarouselShell ul","#galleryv2Modal").data("total-count"),this.currentImageId=$(".galleryCarouselShell ul li[data-picture-position=1]","#galleryv2Modal").data("picture-id")},Truncate:function(a,b){return!a||a.length<=b?a:"<details><summary>"+$.trim(a).substring(0,b)+"</summary><p>"+a+"<span>...close</span></p></details>"},AddMoreLinksToSummary:function(){$(".slideshowv2 details summary").each(function(){$(this).children().length>0||$(this).append("<span>...more</span>")})},LoadMPU:function(){ExpressApp.Log("LoadMPU",gptadslots);var a=gptadslots[9]||gptadslots[99];if(ExpressApp.Config.amazonAds)try{ExpressApp.Log("[apstag]","Fetching bids"),apstag.fetchBids({slots:gptadtags.filter(function(b){return a.getSlotElementId()===b.slotID})},function(b){ExpressApp.Log("[apstag]","Bids returned",b),googletag.cmd.push(function(){ExpressApp.Log("[apstag]","Setting display bids and refreshing adslot"),apstag.setDisplayBids(),ExpressApp.Log("LoadMPU:",[a]),googletag.pubads().refresh([a])})})}catch(b){ExpressApp.Log("[apstag]","Error thrown:",b)}else googletag.cmd.push(function(){ExpressApp.Log("LoadMPU:",[a]),googletag.pubads().refresh([a])})},RefreshMPU:function(){ExpressApp.Log("RefreshMPU");var a=gptadslots[9]||gptadslots[99];if(ExpressApp.Config.amazonAds)try{ExpressApp.Log("[apstag]","Fetching bids"),apstag.fetchBids({slots:gptadtags.filter(function(b){return a.getSlotElementId()===b.slotID})},function(b){ExpressApp.Log("[apstag]","Bids returned",b),googletag.cmd.push(function(){ExpressApp.Log("[apstag]","Setting display bids and refreshing adslot"),apstag.setDisplayBids(),ExpressApp.Log("RefreshMPU:",[a]),googletag.pubads().refresh([a])})})}catch(b){ExpressApp.Log("[apstag]","Error thrown:",b)}else googletag.cmd.push(function(){ExpressApp.Log("RefreshMPU:",[a]),googletag.pubads().refresh([a])})},CheckIfWeNeedToRefreshMPU:function(){this.currentImage%5===0&&ExpressApp.EmbededGalleryV2.RefreshMPU()},GetRelatedGallery:function(){this.galleryMetaTitle=$(".slideshowv2").data("gallerymetatitle"),this.gallerySectionId=$(".slideshowv2").data("gallerysectionid"),this.galleryId=$(".slideshowv2").data("galleryid");var a=this.galleryMetaTitle,b=this.gallerySectionId,c=this.galleryId,d=this;$.ajax({cache:!1,url:WEBROOT+"pictures/ajax_get_related_gallery/"+encodeURIComponent(a)+"/"+b+"/"+c,dataType:"json",type:"POST",success:function(a){if(a&&a.length){slideshowmoreImg=ExpressApp.EmbededGalleryV2.BuildGalleryCoverImageURL(a[0]);var b=document.createElement("IMG");b.src=slideshowmoreImg,gallerycreated=new Date(a[0].Gallery.created);var c='<article class="subsequent"><a href="'+a[0].Gallery.url+'" data-href="'+a[0].Gallery.data_url+'" class="photo"><div><img class="loaded" src="'+slideshowmoreImg+'" alt="'+a[0].Photo.alt+'" title="'+a[0].Photo.caption+'"></div><header><h2>'+a[0].Gallery.headline+'</h2><var class="icoPictures"></var><span>'+a[0].Gallery.created_formatted+"</span></header></a></article>";$(".slideshowmore").html(c),$(".subsequent a").on("click",function(a){return d.options.followRelatedGalleriesHref?void localStorage.setItem("doNotOpenModalGallery",1):(a.preventDefault(),ExpressApp.EmbededGalleryV2.EmptyModal(),ExpressApp.EmbededGalleryV2.options.url=$(this).data("href"),void ExpressApp.EmbededGalleryV2.OpenModal())})}},beforeSend:function(){},complete:function(){}})}},ExpressApp.Entities={triggers:{loadMore:'[data-trigger="loadmore"]'},elements:{shell:".entities"},Init:function(){ExpressApp.Entities.Listener()},Listener:function(){$(ExpressApp.Entities.triggers.loadMore).on("click",function(){ExpressApp.Entities.LoadMore(this)})},LoadMore:function(a){var b=$(a).closest("[data-entity]"),c=$(a);if(!$(b).data("lock")){search_phrase=$(b).data("entity"),entity_id=$(b).data("entity-id"),offset=$(b).data("entity"+entity_id+"-offset"),excludedPosts=[],$(ExpressApp.Entities.elements.shell+" [data-post-id]").each(function(){$(this).data("post-id")&&excludedPosts.push($(this).data("post-id"))});var d="/latest/"+search_phrase+"?loadmore="+offset;$.ajax({cache:!1,url:d,dataType:"json",type:"POST",data:"excluded="+JSON.stringify(excludedPosts)+"&offset="+offset,success:function(a){0==a.found?$(c).fadeOut(100,function(){$(this).remove()}):$(b).data("entity"+entity_id+"-offset",$(b).data("entity"+entity_id+"-offset")+5),items=[],jQuery.each(a.hit,function(a,b){items.push(tmpl("tmpl-entities-posts-item",b))}),$(c).before(tmpl("tmpl-entities-posts-shell",{entitiesPostsItems:items.join("")})),$(window).trigger("scroll")},beforeSend:function(){$(b).data("lock",!0),ExpressApp.Preload.Start($(c),{right:15,left:"auto"})},complete:function(){ExpressApp.Preload.Stop($(c)),$(b).data("lock",!1),$(c).removeClass("blocked")}})}}},ExpressApp.Gigya={sharecount:0,loggingIn:!1,showSignInTimeout:null,init:function(){ExpressApp.Log("ExpressApp.Gigya.loggingIn",ExpressApp.Gigya.loggingIn),ExpressApp.Gigya.loggingIn&&(ExpressApp.Log("App.Gigya.getUserInfo()"),ExpressApp.Gigya.getUserInfo()),$("#gigyasignout").click(function(a){a.preventDefault(),gigya.accounts.logout()}),$("#signedinpanel").click(function(){$("ul#gigyaactions").toggleSlide()}),$("#registerbutton").click(function(a){a.preventDefault(),ExpressApp.Gigya.showRegister()}),$("#signinbutton").click(function(a){a.preventDefault(),ExpressApp.Gigya.showSignIn()}),gigya.accounts.addEventHandlers({onLogin:ExpressApp.Gigya.loginEventHandler,onLogout:ExpressApp.Gigya.logoutEventHandler,onHide:ExpressApp.Gigya.restoreNormality}),gigya.socialize.addEventHandlers({onLogin:ExpressApp.Gigya.loginEventHandler,onLogout:ExpressApp.Gigya.logoutEventHandler,onHide:ExpressApp.Gigya.restoreNormality}),$("#gigyaeditprofile").click(function(a){a.preventDefault(),gigya.accounts.showScreenSet({screenSet:"Profile-Express-web",mobileScreenSet:"Mobile-Express-login",onHide:ExpressApp.Gigya.restoreNormality}),ExpressApp.Gigya.displayModalWindow()})},checkCounters:function(){$(".single-article .gig-counter:hidden").each(function(){var a=$(".gig-counter-text",this).html();a=parseInt(a),!isNaN(a)&&a>0&&$(this).show()}),setTimeout("ExpressApp.Gigya.checkCounters()",1e3)},displayUserSignedIn:function(a){ExpressApp.Log("displayUserSignedIn"),ExpressApp.Gigya.loggingIn=!1,window.utag_data.user.gigya_object=a;var b=new CustomEvent("gigya-user-signed-in",{detail:{user:a}});document.dispatchEvent(b),ExpressApp.GigyaExpresso.Load(function(){if(ExpressApp.Log("expresso loaded..."),ExpressApp.Log(window.widgetView),window.widgetView)window.widgetView.showLoggedInUi();else var a=0,b=setInterval(function(){(a>20||window.widgetView)&&(window.widgetView.showLoggedInUi(),ExpressApp.Log("now expresso loaded after...",a,"attempt(s)"),clearInterval(b)),a++},50)})},confirmDisplayLogin:function(){clearTimeout(ExpressApp.Gigya.showSignInTimeout),ExpressApp.Gigya.showSignInTimeout=null,$(".nse_known-user").length?$("#signedinpanel, .nse_known-user").show():ExpressApp.Gigya.showSignInTimeout=window.setTimeout(function(){ExpressApp.Gigya.confirmDisplayLogin()},500)},displayUserSignedOut:function(){delete window.utag_data.user.gigya_object,window.SPOTIM&&window.SPOTIM.hasOwnProperty("logout")&&window.SPOTIM.logout()},displayModalWindow:function(){$("div.container, #cookielaw, #trybeta, #superbanner").addClass("blur"),$("body").prepend('<div id="whitewash" />')},hideModalWindow:function(){$("div.container, #cookielaw, #trybeta, #superbanner").removeClass("blur"),$("#whitewash").remove()},getUserInfo:function(){ExpressApp.Log("getUserInfo"),gigya.socialize.getUserInfo({callback:ExpressApp.Gigya.printUserResponse})},printUserResponse:function(a){ExpressApp.Log("printUserResponse()",a),a.user.firstName?ExpressApp.Gigya.displayUserSignedIn(a.user):ExpressApp.Gigya.displayUserSignedOut()},loginSocializeEventHandler:function(a){ExpressApp.DataLayer.TrackEvent({call_type:"event",events:{category:"Login",action:"Login Successful",event:"login_successful"},user:{id:a.user.UID,login_platform:a.user.provider}}),ExpressApp.Gigya.displayUserSignedIn(a.user)},loginEventHandler:function(a){ExpressApp.Log(a),ExpressApp.Gigya.loggingIn===!1&&a.hasOwnProperty("user")&&a.user.hasOwnProperty("UID")&&(ExpressApp.Gigya.loggingIn=!0,ExpressApp.DataLayer.TrackEvent({call_type:"event",events:{category:"Login",action:"Login Successful",event:"login_successful"},user:{id:a.user.UID,login_platform:a.user.provider}}),ExpressApp.Gigya.displayUserSignedIn(a.user))},logoutEventHandler:function(){ExpressApp.Gigya.displayUserSignedOut()},restoreNormality:function(){ExpressApp.Gigya.hideModalWindow()},showSignIn:function(){ExpressApp.DataLayer.TrackEvent({call_type:"event",events:{category:"Login",action:"Display Login",event:"login_popup"}}),gigya.accounts.showScreenSet({screenSet:"Login-Express-web",mobileScreenSet:"Mobile-Express-login",onHide:ExpressApp.Gigya.restoreNormality}),ExpressApp.Gigya.displayModalWindow()},showRegister:function(){ExpressApp.DataLayer.TrackEvent({call_type:"event",events:{category:"Registration",action:"Display Registration",event:"registration_popup"}}),gigya.accounts.showScreenSet({screenSet:"Login-Express-web",mobileScreenSet:"Mobile-Express-login",startScreen:"gigya-register-screen",onHide:ExpressApp.Gigya.restoreNormality}),ExpressApp.Gigya.displayModalWindow()},smallShare:function(a){var b=new gigya.socialize.UserAction,c=a.parent().siblings("a.story"),d=ExpressApp.Gigya.sharecount;a.attr({id:"gigyashare"+d,href:"#",onClick:"return false;"}),ExpressApp.Gigya.sharecount++,b.setUserMessage("Share");var e=c.children(".caption").text();c.children(".caption").length||(e=c.children(".title").text()),b.setTitle(e),b.setLinkBack(c.attr("href")),b.setDescription(c.children("p").text()),b.addMediaItem({type:"image",src:c.children().find("img").attr("src"),href:c.attr("href")});var f={containerID:"gigyashare"+d,shareButtons:[{provider:"Share",iconImgUp:"https://cdns.gigya.com/gs/i/sharebar/icons/share3.png",noButtonBorders:!0,iconOnly:"false"}],iconsOnly:"true",userAction:b};gigya.socialize.showShareBarUI(f)}},ExpressApp.HtmlSlider={init:function(a,b){$("#htmlSlider"+a+' .sliderSlides [rel="0"]').addClass("active").show(),$("#htmlSlider"+a+" .slider").removeClass("preloader"),$("#htmlSlider"+a+" .leftArrow").click(function(){ExpressApp.HtmlSlider.moveLeft(a,b)}),$("#htmlSlider"+a+" .rightArrow").click(function(){ExpressApp.HtmlSlider.moveRight(a,b)}),setInterval(function(){ExpressApp.HtmlSlider.moveRight(a,b)},5e3)},moveLeft:function(a,b){var c=parseInt($("#htmlSlider"+a+" .sliderSlides .active").attr("rel")),d=0===c?b:c-1;$("#htmlSlider"+a+" .sliderSlides .active").hide().removeClass("active"),$("#htmlSlider"+a+' .sliderSlides [rel="'+d+'"]').addClass("active").fadeIn()},moveRight:function(a,b){var c=parseInt($("#htmlSlider"+a+" .sliderSlides .active").attr("rel")),d=c===b?0:c+1;$("#htmlSlider"+a+" .sliderSlides .active").hide().removeClass("active"),$("#htmlSlider"+a+' .sliderSlides [rel="'+d+'"]').addClass("active").fadeIn();

}},ExpressApp.SplitImage={Init:function(){$(".splitImage").twentytwenty(),$(".twentytwenty-after").click(function(){var a=$(this).parents(".twentytwenty-container"),b=a.height(),c=a.find("img").width();a.find(".twentytwenty-handle").animate({left:c+"px"},100,function(){a.find(".twentytwenty-before").attr("style","clip: rect(0, "+c+"px, "+b+"px, 0);")})}),$(".twentytwenty-before").click(function(){var a=$(this).parents(".twentytwenty-container"),b=a.height();a.find(".twentytwenty-handle").animate({left:0},100,function(){a.find(".twentytwenty-before").attr("style","clip: rect(0, 0, "+b+"px, 0);")})})}},ExpressApp.ScreenWatcher=function(a){function b(){j.on("resize",function(){d()&&h(c())})}function c(){var a=j.width();for(var b in i)if(i.hasOwnProperty(b)&&a>=i[b])return i[b];return i.MOBILE}function d(){var a=j.width();if(null==k)return k=a,!0;var b=e(k,a);return k=a,b}function e(a,b){if(a===b)return!1;var c=b>a?a:b,d=a>b?a:b;for(var e in i)if(i.hasOwnProperty(e)){var f=i[e];if(f>=c&&d>=f)return!0}return!1}function f(a){l.push(a)}function g(a){l=l.filter(function(b){return b!==a?b:void 0})}function h(a){l.forEach(function(b){b.call(window,a)})}var i={DESKTOP:980,TABLET:768,MOBILE:240};Object.freeze(i);var j=a(window),k=null,l=[];return b(),{subscribe:f,unsubscribe:g,screenType:c,screenTypes:i}}(jQuery),document.addEventListener("spot-im-conversation-loaded",function(){ExpressApp.Spot.spotApiReady||(ExpressApp.Spot.spotApiReady=!0),ExpressApp.Log("spot-im-conversation-loaded: removing preloader?",ExpressApp.Spot.gigyaSignedIn),ExpressApp.Spot.gigyaSignedIn&&ExpressApp.Preload.Stop($(".sppre_frame-container"))}),$(document).on("mouseover",".nse_known-user",function(){$(this).addClass("active").find(".nse_widget-list").show(),$(this).find(".nse_profile-photo").show()}),$(document).on("mouseout",".nse_known-user",function(){$(this).removeClass("active").find(".nse_widget-list").hide(),$(this).find(".nse_profile-photo").hide()}),$(document).on("mouseover",'[data-gigya="profile-image"]',function(){$("#nse-widget").data("loggedin")&&$('[data-gigya="profile-image"]').addClass("active")}),$(document).on("mouseout",'[data-gigya="profile-image"]',function(){$('[data-gigya="profile-image"]').removeClass("active")}),$(function(){ExpressApp.ImageSwap.Init(),ExpressApp.SplitImage.Init(),$("[placeholder]").placeholder(),ExpressApp.Gigya.init();var a=new Detector;ie9&&!a.detect("Open Sans Condensed")&&a.detect("Calibri")&&($(".main-nav > li > a").css({"padding-left":"14px","padding-right":"14px","font-weight":"normal"}),$(".sub-nav > li > a").css({"font-weight":"normal"})),ExpressApp.jsonGalleries={},$('[data-action="external-gallery"]').each(function(){if(3==GALLERY_VERSION){var a=$(this).data("target"),b=a.split("/").pop(),c=$(this);$.ajax({url:a,data:{section_id:SECTION_ID,gallery_version:GALLERY_VERSION,is_standalone:0},success:function(a){ExpressApp.EmbededGalleryV2.Prepare(c,b,a,{data:{section_id:SECTION_ID,gallery_version:2}})}})}else $(this).on("click",function(a){a.preventDefault(),ExpressApp.EmbededGalleryV2.Initiate({url:$(this).data("target"),data:{section_id:SECTION_ID,gallery_version:GALLERY_VERSION,is_standalone:0}})})}),$('a[rel="external"], a[rel="nofollow"]').click(function(){return ExpressApp.GoogleAnalytics.TrackEvent("offsite",$(this).attr("href")),window.open($(this).attr("href")),!1}),$("input.with-shadow").focus(function(){$(this).next().toggleClass("on")}).blur(function(){$(this).next().toggleClass("on")}),ExpressApp.Image.Load(".sponsored-section img",function(){$(".sponsored-section img").height()<51&&("a"==$(".sponsored-section img").parent()[0].tagName.toLowerCase()?$(".sponsored-section img").parent().addClass("small"):$(".sponsored-section img").addClass("small"))}),$("a.reveal").click(function(a){a.preventDefault();var b=$("<div>").addClass("reveal-modal").appendTo("body"),c=$(this);$.get(c.attr("href"),function(a){return b.empty().html(a).append('<a class="close-reveal-modal">&#215;</a>').reveal()})}),$(document).on("click","a.print",function(a){return a.preventDefault(),window.print(),!1}),$("ul.main-nav li a, ul.sub-nav li a").on("click",function(){ExpressApp.DataLayer.TrackEvent({call_type:"event",events:{category:"User Navigation",action:"Navigation Click",event:"user_navigation_click"},navigation:{name:$(this).text()}})}),$(document).on("click",'[data-toggle="reveal"]',function(a){return a.preventDefault(),ExpressApp.Modal.Open(null,this),!1}),$(document).on("click",'[data-toggle="dismiss-notice"]',function(a){return a.preventDefault(),$("#"+$(this).attr("data-notice")).fadeOut("normal",function(){$(this).remove()}),!1}),$(document).on("click",'[data-toggle="scroll"]',function(a){a.preventDefault();var b=$(this).attr("data-target")||"#"+$(this).attr("href").split("#")[1],c=$(b)||$('[name="'+b.replace("#","")+'"]');return c.length&&$("html, body").animate({scrollTop:c.offset().top},"slow","easeOutExpo"),!1}),$(document).on("mouseenter mouseleave",'[data-toggle="hover"]',function(a){var b=$(this),c=b.attr("data-hover-class")||"hover";"mouseenter"===a.type?b.addClass(c):b.removeClass(c)}),function(){$('[data-enhance="file"]').parent().addClass("enhanced"),$('[data-enhance="file"]').parent().css({cursor:"pointer"}),$('[data-enhance="file"]').parent().mousemove(function(a){var b=$(this).offset(),c=parseInt(a.pageX-b.left).toFixed(0),d=parseInt(a.pageY-b.top).toFixed(0);$(this).find('[data-enhance="file"]').css({left:c-$(this).find('[data-enhance="file"]').width()+10,top:d-$(this).find('[data-enhance="file"]').height()+10,bottom:"auto",right:"auto",opacity:0,"z-index":3})}).trigger("mousemove")}(),$("select:not(.nodropkick)").dropkick(),ExpressApp.Horoscope.ActivateHoroscopeDropbox(),ExpressApp.Search.Bind(".search-form form")}),$(window).load(function(){var a=$("#singleArticle").find('[data-type="article-body"]').height();a&&ExpressApp.GoogleAnalytics.TrackArticleLength(a),ExpressApp.ImageLazyLoad()}),$(function(){function a(a,b,c,d,e){a.removeClass(d),b.hide(),c.val(""),setTimeout(function(){a.removeClass(e)},130)}var b=$("#header_addons .search-form form"),c=b.children("input"),d=b.children("button"),e=b.children(".close"),f="active",g="activeAnimate",h=$("#header-search .autocomplete");d.on("click",function(d){b.hasClass(f)?""===c.val()&&(d.preventDefault(),a(b,h,c,f,g)):(d.preventDefault(),b.addClass(f),b.addClass(g),c.focus(),c.val(""))}),e.on("click",function(){a(b,h,c,f,g)})});;var Election2015={};Election2015.Live={intervalId:null,intervalTime:6e4,timeoutSet:!1,Init:function(){Election2015.Live.intervalId=setInterval(Election2015.Live.Update,Election2015.Live.intervalTime),Election2015.Live.Load()},Update:function(){var a=$('[data-election="race"]');a.length&&$.ajax({url:WEBROOT+"constituencies/raceToParliamentLive",success:function(b){a.html(b)}}),Election2015.Live.timeoutSet||(Election2015.Live.timeoutSet=!0,setTimeout(function(){clearInterval(Election2015.Live.intervalId),Election2015.Live.timeoutSet=!1,Election2015.Live.intervalTime*=2,Election2015.Live.Init()},18e5))},Load:function(){var a=$('[data-load="election-race"]');a.length&&(ExpressApp.Preload.Start(a),$.ajax({url:WEBROOT+"constituencies/raceToParliamentLive",success:function(b){a.find('[data-election="race"]').html(b)},complete:function(){ExpressApp.Preload.Stop(a)}}))}},Election2015.Search={Listener:function(){$.hook("search-type").click(function(){var a=$(this).val(),b=$(this).parents("[data-search]").find('[data-hook="search-field"]');b.attr("placeholder",b.data("placeholder")+a)})}},Election2015.Tabs={Init:function(){if($('[data-trigger="election-tabs"]').find("[data-tab]").on("click",function(){Election2015.Tabs.Switch($(this).data("tab"))}),window.location.hash.length>1){var a=window.location.hash.substr(1);$('[data-tab="'+a+'"]').length&&Election2015.Tabs.Switch(a)}},Switch:function(a){$("[data-tab], [data-tab-container]").removeClass("active"),$('[data-tab="'+a+'"], [data-tab-container="'+a+'"]').addClass("active"),window.location.hash="#"+a}},Election2015.Chart={CreateInstance:function(a,b){this.canvas=a,this.ctx=a.getContext("2d"),this.chart=new Chart(this.ctx).Doughnut(b,{segmentStrokeWidth:1,animationSteps:1,responsive:!0,percentageInnerCutout:"46.5",tooltipTemplate:"<%if (label){%><%=label%>: <%= value %><%} else {%> N/A <%}%>",customTooltips:function(b){var c=$('[data-tooltip="'+$(a).data("tooltipContainer")+'"]');if(!b)return void c.css({opacity:0});c.removeClass("above below"),c.addClass(b.yAlign),c.html(b.text);var d;d="above"==b.yAlign?b.y-b.caretHeight-b.caretPadding:b.y+b.caretHeight+b.caretPadding,c.css({opacity:1,left:b.chart.canvas.offsetLeft+b.x+"px",top:b.chart.canvas.offsetTop+d+"px",fontFamily:b.fontFamily,fontSize:b.fontSize,fontStyle:b.fontStyle})}})},Init:function(a,b){$(a).each(function(){var a=new Election2015.Chart.CreateInstance(this,b);$(this).data("chart",a)})},Update:function(a,b){var c=$(a).data("chart");c&&c.chart.destroy(),Election2015.Chart.Init(a,b)}},Election2015.ConstituencyColumn={tmplMps:"election-mps",tmplMajority:"election-majority",tmplTurnout:"election-turnout",Update:function(a,b){a.find(".disabled").removeClass("disabled"),a.find('[data-id="copy"]').addClass("disabled"),a.find('[data-election-tpl-id="title"]').text(b.Constituency.title),a.find('[data-election-tpl-id="mps"]').html(tmpl(this.tmplMps,b)),a.find('[data-election-tpl-id="majority"]').html(tmpl(this.tmplMajority,b)),a.find('[data-election-tpl-id="turnout"]').html(tmpl(this.tmplTurnout,b)),a.find('[data-election-tpl-id="goto"]').attr("href",b.Constituency.link)},Search:function(a,b,c){ExpressApp.Preload.Start(a.parents("[data-tab-container]"),{left:70,top:160}),$.ajax({url:WEBROOT+"constituencies/ajaxpostcode_search/"+b+"/"+(c?1:0),dataType:"json",success:function(b){if(b.error)Election2015.ConstituencyColumn.NoResults(a);else{var c=a.find('[data-ui="chart"]');Election2015.ConstituencyColumn.Update(a,b.items),setTimeout(function(){Election2015.Chart.Update(c,b.items.Result.chart)},1)}},complete:function(){ExpressApp.Preload.Stop(a.parents("[data-tab-container]"))}})},NoResults:function(a){a.find("[data-id]").addClass("disabled"),a.find('[data-id="title"]').removeClass("disabled").text("No results. Try something different.")},Init:function(){$('[data-action="election-live-search"]').on("submit",function(){return Election2015.ConstituencyColumn.Search($(this).parents("[data-container]"),$(this).find('[type="text"]').val(),$(this).parents("[data-live]").data("live")),!1})}},Election2015.Map={intervalId:null,intervalTime:6e4,election_year:2015,Present:function(a,b,c){ExpressApp.Preload.Start($('[data-container="'+c+'"]').parents("[data-tab-container]"),{left:70,top:160}),$.ajax({url:WEBROOT+"politics/constituencies/ajaxid_search/"+a+"/"+b+"/"+Election2015.Map.election_year,dataType:"json",success:function(a){if(a.error)Election2015.ConstituencyColumn.NoResults();else{var b=$('[data-container="'+c+'"]').find('[data-ui="chart"]');Election2015.ConstituencyColumn.Update($('[data-container="'+c+'"]'),a.items),setTimeout(function(){Election2015.Chart.Update(b,a.items.Result.chart)},1)}},complete:function(){ExpressApp.Preload.Stop($('[data-container="'+c+'"]').parents("[data-tab-container]"))}})},Init:function(){$("[data-map]").on("click","[data-hexagon-key]",function(){Election2015.Map.Present($(this).data("hexagonKey"),$(this).parents("[data-live]").data("live"),$(this).parents("[data-target]").data("target"))}),Election2015.Map.Refresh()},SetYear:function(a){Election2015.Map.election_year=a},Refresh:function(){Election2015.Map.intervalId=setInterval(Election2015.Map.Update,Election2015.Map.intervalTime)},Update:function(){var a=$('[data-election="map"]');a.length&&$.ajax({url:WEBROOT+"constituencies/mapLive",success:function(b){var c=a.parents("[data-tab-container]");a.html(b),c.find('[data-id="Copy"]').hasClass("disabled")||$.ajax({url:WEBROOT+"constituencies/getLastUpdatedConstituency",dataType:"json",success:function(a){if(!a.error){var b=c.find('[data-ui="chart"]');Election2015.ConstituencyColumn.Update(c.find("[data-container]"),a.items),setTimeout(function(){Election2015.Chart.Update(b,a.items.Result.chart)},1)}}})}}),setTimeout(function(){clearInterval(Election2015.Map.intervalId),Election2015.Map.intervalTime*=2,Election2015.Map.Refresh()},18e5)}},$(function(){Election2015.Search.Listener(),Election2015.Tabs.Init(),Election2015.Map.Init(),Election2015.ConstituencyColumn.Init(),Election2015.Live.Init()});